<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>gorm-delete</title><meta name="robots" content="follow, index"/><meta name="description" content=""/><meta property="og:url" content="https://demian9k.github.io/blog/gorm-delete"/><meta property="og:type" content="article"/><meta property="og:site_name" content="demian11k"/><meta property="og:description" content=""/><meta property="og:title" content="gorm-delete"/><meta property="og:image" content="https://demian9k.github.io/static/images/twitter-card.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="gorm-delete"/><meta name="twitter:description" content=""/><meta name="twitter:image" content="https://demian9k.github.io/static/images/twitter-card.png"/><link rel="canonical" href="https://demian9k.github.io/blog/gorm-delete/"/><meta property="article:published_time" content="2023-11-23T22:11:33.000Z"/><meta property="article:modified_time" content="2023-11-26T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://demian9k.github.io/blog/gorm-delete"
  },
  "headline": "gorm-delete",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://demian9k.github.io/static/images/twitter-card.png"
    }
  ],
  "datePublished": "2023-11-23T22:11:33.000Z",
  "dateModified": "2023-11-26T00:00:00.000Z",
  "author": {
    "@type": "Person",
    "name": "demian11k"
  },
  "publisher": {
    "@type": "Organization",
    "name": "demian11k",
    "logo": {
      "@type": "ImageObject",
      "url": "https://demian9k.github.io/static/images/logo.png"
    }
  },
  "description": ""
}</script><meta name="next-head-count" content="21"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/94ea37d977b78d30.css" as="style"/><link rel="stylesheet" href="/_next/static/css/94ea37d977b78d30.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-781a92acf59ed6b5.js" defer=""></script><script src="/_next/static/chunks/main-bfc1a3b6dd286443.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e22266d47111418b.js" defer=""></script><script src="/_next/static/chunks/140-77b8ab5a870d524b.js" defer=""></script><script src="/_next/static/chunks/574-40cb695d6b511631.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-48fd063b43fdbe6a.js" defer=""></script><script src="/_next/static/otfPwKwSsy3CYkkcjSJd6/_buildManifest.js" defer=""></script><script src="/_next/static/otfPwKwSsy3CYkkcjSJd6/_ssgManifest.js" defer=""></script><script src="/_next/static/otfPwKwSsy3CYkkcjSJd6/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="demian11k" href="/"><div class="flex items-center justify-between"><div class="mr-3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2740%27%20height=%2740%27/%3e"/></span><img alt="A" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="rounded-full object-cover object-center md:h-36 lg:h-48" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="A" srcSet="/_next/static/media/demian_avatar_logo.73bd1e6e.png?imwidth=48 1x, /_next/static/media/demian_avatar_logo.73bd1e6e.png?imwidth=96 2x" src="/_next/static/media/demian_avatar_logo.73bd1e6e.png?imwidth=96" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="rounded-full object-cover object-center md:h-36 lg:h-48" loading="lazy"/></noscript></span></div><div class="hidden h-6 text-2xl font-semibold leading-4 sm:block">demian11k</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/projects">Projects</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">Projects</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div><header><div class="space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700"><dl><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2023-11-23T22:11:33.000Z">November 24, 2023</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">gorm-delete</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0 " style="grid-template-rows:auto 1fr"><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><h3 id="1개-레코드-삭제하기-delete-a-record"><a href="#1개-레코드-삭제하기-delete-a-record" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>1개 레코드 삭제하기 (Delete a Record)</h3><p>1개 레코드를 삭제할때 삭제하려는 값은 pk나 조건을 가져야 하며, 그렇지 않으면 batch delete가 실행된다.</p><div class="remark-code-title">delete_01_test.go</div><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line">
</span><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;errors&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;fmt&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;github.com/stretchr/testify/assert&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;gorm.io/gorm&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;testing&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;time&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">TestDeleteRecord</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	db <span class="token operator">:=</span> <span class="token function">MustGormMySQLGormExampleDBConnectionPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MigrationEntities</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token operator">&amp;</span>Email<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	err <span class="token operator">:=</span> <span class="token function">CreateTestData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	email <span class="token operator">:=</span> Email<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">if</span> tx1 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>email<span class="token punctuation">)</span><span class="token punctuation">;</span> tx1<span class="token punctuation">.</span>Error <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		t<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	tx1 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>email<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE from emails where id = 10;</span>
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx1<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Delete with additional conditions</span>
</span><span class="code-line">	tx2 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;name = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jinzhu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>email<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE from emails where id = 10 AND name = &quot;jinzhu&quot;;</span>
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx2<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="pk로-삭제하기-delete-with-primary-key"><a href="#pk로-삭제하기-delete-with-primary-key" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>pk로 삭제하기 (Delete with primary key)</h3><div class="remark-code-title">delete_01_test.go</div><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token function">TestDeleteWithPK</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	db <span class="token operator">:=</span> <span class="token function">MustGormMySQLGormExampleDBConnectionPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MigrationEntities</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	err <span class="token operator">:=</span> <span class="token function">CreateTestData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	gen <span class="token operator">:=</span> NewDummyDataGenerator<span class="token punctuation">[</span>User<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
</span><span class="code-line">	gen<span class="token punctuation">.</span><span class="token function">GenP</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token boolean">_</span> <span class="token builtin">int</span><span class="token punctuation">,</span> email <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		email<span class="token punctuation">.</span>ID <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	tx1 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM users WHERE id = 10;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx1<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	tx2 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM users WHERE id = 10;</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx2<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">//PK Slice를 인수로 사용하여 in operator로 삭제하기</span>
</span><span class="code-line">	users <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">	tx3 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM users WHERE id IN (1,2,3);</span>
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx3<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="delete-hooks"><a href="#delete-hooks" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Delete Hooks</h3><p>delete 로직에 hook 사용하기</p><p>GORM 에서는 database에서 실제로 SQL을 <strong>실행하기 전이나 후에 실행되는 함수</strong>인 Hook이 있고 Delete operation 에서는 <code>BeforeDelete</code>, <code>AfterDelete</code> Hook을 사용할 수 있다.</p><div class="remark-code-title">delete_01_test.go</div><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token function">TestDeleteHooks</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	db <span class="token operator">:=</span> <span class="token function">MustGormMySQLGormExampleDBConnectionPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MigrationEntities</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token operator">&amp;</span>User13<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	err <span class="token operator">:=</span> <span class="token function">CreateTestData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	user <span class="token operator">:=</span> User13<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;jinjhu&quot;</span><span class="token punctuation">,</span> Role<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">	db<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	tx1 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx1<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">type</span> User13 <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">	ID        <span class="token builtin">uint</span> <span class="token string">`gorm:&quot;primaryKey;autoIncrement&quot;`</span>
</span><span class="code-line">	Name      <span class="token builtin">string</span>
</span><span class="code-line">	Age       <span class="token builtin">int64</span>
</span><span class="code-line">	Birthday  time<span class="token punctuation">.</span>Time
</span><span class="code-line">	CreatedAt time<span class="token punctuation">.</span>Time
</span><span class="code-line">	UpdatedAt time<span class="token punctuation">.</span>Time
</span><span class="code-line">	Role      <span class="token builtin">string</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token punctuation">(</span>u <span class="token operator">*</span>User13<span class="token punctuation">)</span> <span class="token function">BeforeDelete</span><span class="token punctuation">(</span>tx <span class="token operator">*</span>gorm<span class="token punctuation">.</span>DB<span class="token punctuation">)</span> <span class="token punctuation">(</span>err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;BeforeDelete&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> u<span class="token punctuation">.</span>Role <span class="token operator">==</span> <span class="token string">&quot;admin&quot;</span> <span class="token punctuation">{</span>
</span><span class="code-line">		<span class="token keyword">return</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;admin user not allowed to delete&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">return</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h2 id="batch-update"><a href="#batch-update" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Batch Update</h2><p>Delete() 실행시 지정된 값에 PK가 없으면 GORM은 batch delete를 실행하여, 조건에 맞는 모든 레코드를 삭제한다.</p><div class="remark-code-title">delete_02_batch_test.go-01</div><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;fmt&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;github.com/stretchr/testify/assert&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;gorm.io/gorm&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;testing&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">TestBatchDelete</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	db <span class="token operator">:=</span> <span class="token function">MustGormMySQLGormExampleDBConnectionPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MigrationEntities</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	err <span class="token operator">:=</span> <span class="token function">CreateTestData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	gen <span class="token operator">:=</span> NewDummyDataGenerator<span class="token punctuation">[</span>User<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
</span><span class="code-line">	gen<span class="token punctuation">.</span><span class="token function">GenP</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token boolean">_</span> <span class="token builtin">int</span><span class="token punctuation">,</span> User <span class="token operator">*</span>User<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		User<span class="token punctuation">.</span>ID <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	email1 <span class="token operator">:=</span> <span class="token operator">&amp;</span>Email<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">	tx1 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;email LIKE ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;%jinzhu%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>email1<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE from emails where email LIKE &quot;%jinzhu%&quot;;</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx1<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	email2 <span class="token operator">:=</span> <span class="token operator">&amp;</span>Email<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">	tx2 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span>email2<span class="token punctuation">,</span> <span class="token string">&quot;email LIKE ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;%jinzhu%&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE from emails where email LIKE &quot;%jinzhu%&quot;;</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx2<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">//다수의 레코드를 효율적으로 삭제하려면, Delete() 메서드에 PK의 slice를 전달하면 IN operator로 처리된다.</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">var</span> users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>User<span class="token punctuation">{</span><span class="token punctuation">{</span>ID<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>ID<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>ID<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="code-line">	tx3 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM users WHERE id IN (1,2,3);</span>
</span><span class="code-line">
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx3<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	tx5 <span class="token operator">:=</span> <span class="token function">CreateEmailData</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token function">int64</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tx5<span class="token punctuation">.</span>RowsAffected<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	users2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>User<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</span><span class="code-line">	tx6 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users2<span class="token punctuation">)</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx6<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	tx4 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users2<span class="token punctuation">,</span> <span class="token string">&quot;name LIKE ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;%jinzhu%&quot;</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM users WHERE name LIKE &quot;%jinzhu%&quot; AND id IN (4,5,6);</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx4<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="global-delete-차단-block-global-delete"><a href="#global-delete-차단-block-global-delete" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Global Delete 차단 (Block Global Delete)</h3><p>삭제할 레코드를 찾는 조건 없이 batch delete를 수행하면 GORM이 실제로 SQL을 실행하지 않고. ErrMissingWhereClause 오류를 반환한다.</p><p>오류 없이 batch delete를 하는 방법은 3가지가 있다.</p><ol><li>where를 사용</li><li>raw sql 을 사용</li><li>AllowGlobalUpdate 모드를 enable</li></ol><div class="remark-code-title">delete_02_batch_test.go-02</div><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">func</span> <span class="token function">TestBlockGlobalDelete</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	db <span class="token operator">:=</span> <span class="token function">MustGormMySQLGormExampleDBConnectionPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MigrationEntities</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	err <span class="token operator">:=</span> <span class="token function">CreateTestData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">CheckFatal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	user <span class="token operator">:=</span> User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;jinjhu&quot;</span><span class="token punctuation">,</span> Role<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">	tx1 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx1<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	user2 <span class="token operator">:=</span> User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;jinjhu&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">//삭제되지 않음</span>
</span><span class="code-line">	tx2 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user2<span class="token punctuation">)</span> <span class="token comment">// gorm.ErrMissingWhereClause</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx2<span class="token punctuation">.</span>Error<span class="token punctuation">,</span> gorm<span class="token punctuation">.</span>ErrMissingWhereClause<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	users1 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>User<span class="token punctuation">{</span><span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;jinzhu1&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;jinzhu2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">//삭제되지 않음</span>
</span><span class="code-line">	tx3 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users1<span class="token punctuation">)</span> <span class="token comment">// gorm.ErrMissingWhereClause</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">Equal</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx3<span class="token punctuation">.</span>Error<span class="token punctuation">,</span> gorm<span class="token punctuation">.</span>ErrMissingWhereClause<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">//삭제됨</span>
</span><span class="code-line">	user3 <span class="token operator">:=</span> User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;jinjhu&quot;</span><span class="token punctuation">,</span> Role<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">	tx4 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;1 = 1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user3<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM `users` WHERE 1=1</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx4<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	tx5 <span class="token operator">:=</span> <span class="token function">CreateUserData</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx5<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">//구조체에서 gorm이 사용할 테이블 이름 가져오기</span>
</span><span class="code-line">	tablename<span class="token punctuation">,</span> err <span class="token operator">:=</span> <span class="token function">GormTableName</span><span class="token punctuation">(</span>user3<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
</span><span class="code-line">		t<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">	tx6 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Exec</span><span class="token punctuation">(</span>fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">`DELETE FROM %s`</span><span class="token punctuation">,</span> tablename<span class="token punctuation">)</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM users</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx6<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	tx7 <span class="token operator">:=</span> <span class="token function">CreateUserData</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx7<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	user4 <span class="token operator">:=</span> User<span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;jinjhu&quot;</span><span class="token punctuation">,</span> Role<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">	tx8 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Session</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>gorm<span class="token punctuation">.</span>Session<span class="token punctuation">{</span>AllowGlobalUpdate<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user4<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM users</span>
</span><span class="code-line">
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx8<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="row들을-삭제한-이후-data-반환-받기--returning-data-from-deleted-rows-"><a href="#row들을-삭제한-이후-data-반환-받기--returning-data-from-deleted-rows-" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>row들을 삭제한 이후 data 반환 받기 ( Returning Data From Deleted Rows )</h3><p>삭제한 row의 데이터를 가져온다. 이 기능은 RETURNING을 지원하는 database만 사용할 수 있다.</p><div class="remark-code-title">delete_03_test.go-01</div><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line"><span class="token keyword">import</span> <span class="token punctuation">(</span>
</span><span class="code-line">	<span class="token string">&quot;github.com/brianvoe/gofakeit/v6&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;github.com/stretchr/testify/assert&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;gorm.io/gorm&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;gorm.io/gorm/clause&quot;</span>
</span><span class="code-line">	<span class="token string">&quot;testing&quot;</span>
</span><span class="code-line"><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">TestReturningDataFromDeletedRows</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	db <span class="token operator">:=</span> <span class="token function">MustGormMySQLGormExampleDBConnectionPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MigrationEntities</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token operator">&amp;</span>User<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	tx1 <span class="token operator">:=</span> <span class="token function">CreateUserData</span><span class="token punctuation">(</span>db<span class="token punctuation">)</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx1<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// 모든 컬럼을 반환하기</span>
</span><span class="code-line">	<span class="token keyword">var</span> users <span class="token punctuation">[</span><span class="token punctuation">]</span>User
</span><span class="code-line">	db<span class="token punctuation">.</span><span class="token function">Clauses</span><span class="token punctuation">(</span>clause<span class="token punctuation">.</span>Returning<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;role = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM `users` WHERE role = &quot;admin&quot; RETURNING *</span>
</span><span class="code-line">	<span class="token comment">// users =&gt; []User{{ID: 1, Name: &quot;jinzhu&quot;, Role: &quot;admin&quot;, Salary: 100}, {ID: 2, Name: &quot;jinzhu.2&quot;, Role: &quot;admin&quot;, Salary: 1000}}</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// 지정된 컬럼을 반환하게 하기</span>
</span><span class="code-line">	db<span class="token punctuation">.</span><span class="token function">Clauses</span><span class="token punctuation">(</span>clause<span class="token punctuation">.</span>Returning<span class="token punctuation">{</span>Columns<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>clause<span class="token punctuation">.</span>Column<span class="token punctuation">{</span><span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>Name<span class="token punctuation">:</span> <span class="token string">&quot;salary&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;role = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>users<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM `users` WHERE role = &quot;admin&quot; RETURNING `name`, `salary`</span>
</span><span class="code-line">	<span class="token comment">// users =&gt; []User{{ID: 0, Name: &quot;jinzhu&quot;, Role: &quot;&quot;, Salary: 100}, {ID: 0, Name: &quot;jinzhu.2&quot;, Role: &quot;&quot;, Salary: 1000}}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre></div><h3 id="soft-delete"><a href="#soft-delete" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Soft Delete</h3><p>gorm은 gorm.DeletedAt 필드를 사용해 soft delete(실제 데이터는 삭제하지 않고 플래그로 삭제됨 표시)를 사용할 수 있다.</p><p>이 모델을 gorm entity에서 사용하면 자동으로 적용된다.</p><p>soft delete가 적용되면 Delete를 실행했을 때 레코드는 database에서 삭제되지 않고 deletedAt 의 값을 현재 시간으로 업데이트한다.</p><p>이렇게 표시된 데이터는 gorm으로 query할 때 일반적인 방법으로는 검색되지 않는다.</p><div class="remark-code-title">delete_03_test.go-02</div><div class="relative"><pre><code class="language-go code-highlight"><span class="code-line">
</span><span class="code-line"><span class="token keyword">func</span> <span class="token function">TestSoftDelete</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	db <span class="token operator">:=</span> <span class="token function">MustGormMySQLGormExampleDBConnectionPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">//softdelete 를 사용하려면 gorm.DeletedAt 필드가 있어야 한다.</span>
</span><span class="code-line">	<span class="token comment">//gorm.Model에도 포함되어 있다.</span>
</span><span class="code-line">	<span class="token keyword">type</span> UserGormModel <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">		gorm<span class="token punctuation">.</span>Model
</span><span class="code-line">		ID   <span class="token builtin">int</span>
</span><span class="code-line">		Age  <span class="token builtin">int</span>
</span><span class="code-line">		Name <span class="token builtin">string</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">type</span> UserDeletedAt <span class="token keyword">struct</span> <span class="token punctuation">{</span>
</span><span class="code-line">		ID      <span class="token builtin">int</span>
</span><span class="code-line">		Age     <span class="token builtin">int</span>
</span><span class="code-line">		Deleted gorm<span class="token punctuation">.</span>DeletedAt
</span><span class="code-line">		Name    <span class="token builtin">string</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">    <span class="token comment">//seqpicker는 입력된 값들을 PickNext할 때마다 순차적으로 반환한다.</span>
</span><span class="code-line">	seqpicker <span class="token operator">:=</span> <span class="token function">NewSeqPicker</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token function">MigrationEntities</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token operator">&amp;</span>UserDeletedAt<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	genUser <span class="token operator">:=</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">		gen2 <span class="token operator">:=</span> NewDummyDataGenerator<span class="token punctuation">[</span>UserDeletedAt<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>
</span><span class="code-line">		gen2<span class="token punctuation">.</span><span class="token function">GenP</span><span class="token punctuation">(</span>db<span class="token punctuation">,</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token boolean">_</span> <span class="token builtin">int</span><span class="token punctuation">,</span> user1 <span class="token operator">*</span>UserDeletedAt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">			user1<span class="token punctuation">.</span>ID <span class="token operator">=</span> <span class="token number">0</span>
</span><span class="code-line">			user1<span class="token punctuation">.</span>Name <span class="token operator">=</span> gofakeit<span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">			user1<span class="token punctuation">.</span>Age <span class="token operator">=</span> seqpicker<span class="token punctuation">.</span><span class="token function">PickNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">			user1<span class="token punctuation">.</span>Deleted <span class="token operator">=</span> gorm<span class="token punctuation">.</span>DeletedAt<span class="token punctuation">{</span>Valid<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
</span><span class="code-line">		<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token function">genUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	user <span class="token operator">:=</span> UserDeletedAt<span class="token punctuation">{</span>ID<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token comment">// user&#x27;s ID is `111`</span>
</span><span class="code-line">	tx1 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span> <span class="token comment">//삭제하지 않고 deleted 필드를 현재 시간값으로 업데이트한다.</span>
</span><span class="code-line">	<span class="token comment">// UPDATE users SET deleted_at=&quot;2013-10-29 10:23&quot; WHERE id = 111;</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx1<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">	user1 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>UserDeletedAt<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">// Batch Delete 삭제하지 않고 deleted 필드를 현재 시간값으로 업데이트한다.</span>
</span><span class="code-line">	tx2 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = ?&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user1<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// UPDATE users SET deleted_at=&quot;2013-10-29 10:23&quot; WHERE age = 10;</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx2<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	user2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>UserDeletedAt<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token comment">// softdelete 된 컬럼은 쿼리에서 제외된다.</span>
</span><span class="code-line">	tx3 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = 20&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user2<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// SELECT * FROM users WHERE age = 20 AND deleted_at IS NULL;</span>
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx3<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	userdel <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>UserDeletedAt<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">//soft deleted 레코드 찾기</span>
</span><span class="code-line">	<span class="token comment">// Unscoped를 사용하면 soft deleted 상태인 row도 찾을 수 있다.</span>
</span><span class="code-line">	tx4 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Unscoped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = 30&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Find</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>userdel<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// SELECT * FROM users WHERE age = 20;</span>
</span><span class="code-line">
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx4<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	userdel2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>UserDeletedAt<span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token comment">//Unscoped를 사용하면 softdelete 쿼리도 hard DELETE 할 수 있다</span>
</span><span class="code-line">	tx5 <span class="token operator">:=</span> db<span class="token punctuation">.</span><span class="token function">Unscoped</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;age = 30&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>userdel2<span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token comment">// DELETE FROM orders WHERE id=10;</span>
</span><span class="code-line">
</span><span class="code-line">	assert<span class="token punctuation">.</span><span class="token function">NoError</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> tx5<span class="token punctuation">.</span>Error<span class="token punctuation">)</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre></div></div></div><div id="comment"></div><footer><div class="flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base"><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/gorm-update">← <!-- -->gorm-update</a></div></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:demian11k@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/demian9k"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>demian11k</div><div> • </div><div>© 2023</div><div> • </div><a href="/">demian11k</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var r=Object.create;var t=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var l=a=\u003et(a,\"__esModule\",{value:!0});var h=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=\u003e{l(a);for(var c in s)t(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let e of d(s))!u.call(a,e)\u0026\u0026e!==\"default\"\u0026\u0026t(a,e,{get:()=\u003es[e],enumerable:!(c=p(s,e))||c.enumerable});return a},g=a=\u003ek(l(t(a!=null?r(m(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var o=h((y,i)=\u003e{i.exports=_jsx_runtime});var D={};N(D,{default:()=\u003eb,frontmatter:()=\u003ef});var n=g(o()),f={title:\"gorm-delete\",date:new Date(1700777493e3),lastmod:\"2023-11-26\",tags:[\"go\",\"orm\"],draft:!1,summary:\"\",layout:\"PostSimple\",canonicalUrl:\"https://demian9k.github.io/blog/gorm-delete/\"};function E(a={}){let{wrapper:s}=a.components||{};return s?(0,n.jsx)(s,Object.assign({},a,{children:(0,n.jsx)(c,{})})):c();function c(){let e=Object.assign({h3:\"h3\",a:\"a\",span:\"span\",p:\"p\",pre:\"pre\",code:\"code\",strong:\"strong\",h2:\"h2\",ol:\"ol\",li:\"li\"},a.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h3,{id:\"1\\uAC1C-\\uB808\\uCF54\\uB4DC-\\uC0AD\\uC81C\\uD558\\uAE30-delete-a-record\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#1\\uAC1C-\\uB808\\uCF54\\uB4DC-\\uC0AD\\uC81C\\uD558\\uAE30-delete-a-record\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"1\\uAC1C \\uB808\\uCF54\\uB4DC \\uC0AD\\uC81C\\uD558\\uAE30 (Delete a Record)\"]}),(0,n.jsx)(e.p,{children:\"1\\uAC1C \\uB808\\uCF54\\uB4DC\\uB97C \\uC0AD\\uC81C\\uD560\\uB54C \\uC0AD\\uC81C\\uD558\\uB824\\uB294 \\uAC12\\uC740 pk\\uB098 \\uC870\\uAC74\\uC744 \\uAC00\\uC838\\uC57C \\uD558\\uBA70, \\uADF8\\uB807\\uC9C0 \\uC54A\\uC73C\\uBA74 batch delete\\uAC00 \\uC2E4\\uD589\\uB41C\\uB2E4.\"}),(0,n.jsx)(\"div\",{className:\"remark-code-title\",children:\"delete_01_test.go\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"errors\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"fmt\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/stretchr/testify/assert\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"gorm.io/gorm\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"testing\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"time\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"TestDeleteRecord\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"testing\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"T\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"MustGormMySQLGormExampleDBConnectionPool\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"MigrationEntities\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"Email\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateTestData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\temail \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" Email\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" tx1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"First\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"email\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\";\"}),\" tx1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Fatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"email\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE from emails where id = 10;\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Delete with additional conditions\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"name = ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"jinzhu\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"email\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// DELETE from emails where id = 10 AND name = \"jinzhu\";'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h3,{id:\"pk\\uB85C-\\uC0AD\\uC81C\\uD558\\uAE30-delete-with-primary-key\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#pk\\uB85C-\\uC0AD\\uC81C\\uD558\\uAE30-delete-with-primary-key\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"pk\\uB85C \\uC0AD\\uC81C\\uD558\\uAE30 (Delete with primary key)\"]}),(0,n.jsx)(\"div\",{className:\"remark-code-title\",children:\"delete_01_test.go\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"TestDeleteWithPK\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"testing\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"T\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"MustGormMySQLGormExampleDBConnectionPool\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"MigrationEntities\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateTestData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tgen \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" NewDummyDataGenerator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tgen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GenP\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" email \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\temail\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ID \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE FROM users WHERE id = 10;\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"11\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE FROM users WHERE id = 10;\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//PK Slice\\uB97C \\uC778\\uC218\\uB85C \\uC0AC\\uC6A9\\uD558\\uC5EC in operator\\uB85C \\uC0AD\\uC81C\\uD558\\uAE30\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tusers \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx3 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"users\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE FROM users WHERE id IN (1,2,3);\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h3,{id:\"delete-hooks\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#delete-hooks\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Delete Hooks\"]}),(0,n.jsx)(e.p,{children:\"delete \\uB85C\\uC9C1\\uC5D0 hook \\uC0AC\\uC6A9\\uD558\\uAE30\"}),(0,n.jsxs)(e.p,{children:[\"GORM \\uC5D0\\uC11C\\uB294 database\\uC5D0\\uC11C \\uC2E4\\uC81C\\uB85C SQL\\uC744 \",(0,n.jsx)(e.strong,{children:\"\\uC2E4\\uD589\\uD558\\uAE30 \\uC804\\uC774\\uB098 \\uD6C4\\uC5D0 \\uC2E4\\uD589\\uB418\\uB294 \\uD568\\uC218\"}),\"\\uC778 Hook\\uC774 \\uC788\\uACE0 Delete operation \\uC5D0\\uC11C\\uB294 \",(0,n.jsx)(e.code,{children:\"BeforeDelete\"}),\", \",(0,n.jsx)(e.code,{children:\"AfterDelete\"}),\" Hook\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,n.jsx)(\"div\",{className:\"remark-code-title\",children:\"delete_01_test.go\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"TestDeleteHooks\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"testing\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"T\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"MustGormMySQLGormExampleDBConnectionPool\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"MigrationEntities\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"User13\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateTestData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuser \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" User13\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"jinjhu\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" Role\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"admin\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" User13 \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tID        \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"uint\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'`gorm:\"primaryKey;autoIncrement\"`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tName      \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tAge       \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int64\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tBirthday  time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`Time\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tCreatedAt time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`Time\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tUpdatedAt time\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`Time\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tRole      \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"u \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"User13\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"BeforeDelete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"tx \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"gorm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"DB\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"err \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"error\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tfmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Println\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"BeforeDelete\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" u\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Role \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"==\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"admin\"'}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),\" errors\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"New\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"admin user not allowed to delete\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"return\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h2,{id:\"batch-update\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#batch-update\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Batch Update\"]}),(0,n.jsx)(e.p,{children:\"Delete() \\uC2E4\\uD589\\uC2DC \\uC9C0\\uC815\\uB41C \\uAC12\\uC5D0 PK\\uAC00 \\uC5C6\\uC73C\\uBA74 GORM\\uC740 batch delete\\uB97C \\uC2E4\\uD589\\uD558\\uC5EC, \\uC870\\uAC74\\uC5D0 \\uB9DE\\uB294 \\uBAA8\\uB4E0 \\uB808\\uCF54\\uB4DC\\uB97C \\uC0AD\\uC81C\\uD55C\\uB2E4.\"}),(0,n.jsx)(\"div\",{className:\"remark-code-title\",children:\"delete_02_batch_test.go-01\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"fmt\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/stretchr/testify/assert\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"gorm.io/gorm\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"testing\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"TestBatchDelete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"testing\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"T\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"MustGormMySQLGormExampleDBConnectionPool\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"MigrationEntities\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateTestData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tgen \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" NewDummyDataGenerator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tgen\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GenP\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" User \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tUser\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ID \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\temail1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"Email\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"email LIKE ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"%jinzhu%\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"email1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// DELETE from emails where email LIKE \"%jinzhu%\";'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\temail2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"Email\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"email2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"email LIKE ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"%jinzhu%\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// DELETE from emails where email LIKE \"%jinzhu%\";'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\\uB2E4\\uC218\\uC758 \\uB808\\uCF54\\uB4DC\\uB97C \\uD6A8\\uC728\\uC801\\uC73C\\uB85C \\uC0AD\\uC81C\\uD558\\uB824\\uBA74, Delete() \\uBA54\\uC11C\\uB4DC\\uC5D0 PK\\uC758 slice\\uB97C \\uC804\\uB2EC\\uD558\\uBA74 IN operator\\uB85C \\uCC98\\uB9AC\\uB41C\\uB2E4.\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" users \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"ID\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"1\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"ID\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"2\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"ID\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx3 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"users\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE FROM users WHERE id IN (1,2,3);\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx5 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateEmailData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Equal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"int64\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"5\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"RowsAffected\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tusers2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"make\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx6 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Limit\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Find\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"users2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx6\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx4 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"users2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"name LIKE ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"%jinzhu%\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// DELETE FROM users WHERE name LIKE \"%jinzhu%\" AND id IN (4,5,6);'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h3,{id:\"global-delete-\\uCC28\\uB2E8-block-global-delete\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#global-delete-\\uCC28\\uB2E8-block-global-delete\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Global Delete \\uCC28\\uB2E8 (Block Global Delete)\"]}),(0,n.jsx)(e.p,{children:\"\\uC0AD\\uC81C\\uD560 \\uB808\\uCF54\\uB4DC\\uB97C \\uCC3E\\uB294 \\uC870\\uAC74 \\uC5C6\\uC774 batch delete\\uB97C \\uC218\\uD589\\uD558\\uBA74 GORM\\uC774 \\uC2E4\\uC81C\\uB85C SQL\\uC744 \\uC2E4\\uD589\\uD558\\uC9C0 \\uC54A\\uACE0. ErrMissingWhereClause \\uC624\\uB958\\uB97C \\uBC18\\uD658\\uD55C\\uB2E4.\"}),(0,n.jsx)(e.p,{children:\"\\uC624\\uB958 \\uC5C6\\uC774 batch delete\\uB97C \\uD558\\uB294 \\uBC29\\uBC95\\uC740 3\\uAC00\\uC9C0\\uAC00 \\uC788\\uB2E4.\"}),(0,n.jsxs)(e.ol,{children:[(0,n.jsx)(e.li,{children:\"where\\uB97C \\uC0AC\\uC6A9\"}),(0,n.jsx)(e.li,{children:\"raw sql \\uC744 \\uC0AC\\uC6A9\"}),(0,n.jsx)(e.li,{children:\"AllowGlobalUpdate \\uBAA8\\uB4DC\\uB97C enable\"})]}),(0,n.jsx)(\"div\",{className:\"remark-code-title\",children:\"delete_02_batch_test.go-02\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"TestBlockGlobalDelete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"testing\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"T\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"MustGormMySQLGormExampleDBConnectionPool\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"MigrationEntities\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\terr \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateTestData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"CheckFatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuser \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"jinjhu\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" Role\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"admin\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Create\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuser2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"jinjhu\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\\uC0AD\\uC81C\\uB418\\uC9C0 \\uC54A\\uC74C\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// gorm.ErrMissingWhereClause\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Equal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" gorm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ErrMissingWhereClause\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tusers1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"jinzhu1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"jinzhu2\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\\uC0AD\\uC81C\\uB418\\uC9C0 \\uC54A\\uC74C\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx3 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"users1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// gorm.ErrMissingWhereClause\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Equal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" gorm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ErrMissingWhereClause\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\\uC0AD\\uC81C\\uB428\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuser3 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"jinjhu\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" Role\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"admin\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx4 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"1 = 1\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE FROM `users` WHERE 1=1\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx5 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateUserData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\\uAD6C\\uC870\\uCCB4\\uC5D0\\uC11C gorm\\uC774 \\uC0AC\\uC6A9\\uD560 \\uD14C\\uC774\\uBE14 \\uC774\\uB984 \\uAC00\\uC838\\uC624\\uAE30\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttablename\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"GormTableName\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"user3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"if\"}),\" err \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"!=\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"nil\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Fatal\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"err\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx6 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Exec\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"fmt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Sprintf\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:\"`DELETE FROM %s`\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tablename\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE FROM users\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx6\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx7 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateUserData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx7\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuser4 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"jinjhu\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" Role\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"admin\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx8 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Session\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"gorm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Session\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"AllowGlobalUpdate\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"true\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE FROM users\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx8\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h3,{id:\"row\\uB4E4\\uC744-\\uC0AD\\uC81C\\uD55C-\\uC774\\uD6C4-data-\\uBC18\\uD658-\\uBC1B\\uAE30--returning-data-from-deleted-rows-\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#row\\uB4E4\\uC744-\\uC0AD\\uC81C\\uD55C-\\uC774\\uD6C4-data-\\uBC18\\uD658-\\uBC1B\\uAE30--returning-data-from-deleted-rows-\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"row\\uB4E4\\uC744 \\uC0AD\\uC81C\\uD55C \\uC774\\uD6C4 data \\uBC18\\uD658 \\uBC1B\\uAE30 ( Returning Data From Deleted Rows )\"]}),(0,n.jsx)(e.p,{children:\"\\uC0AD\\uC81C\\uD55C row\\uC758 \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uC838\\uC628\\uB2E4. \\uC774 \\uAE30\\uB2A5\\uC740 RETURNING\\uC744 \\uC9C0\\uC6D0\\uD558\\uB294 database\\uB9CC \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,n.jsx)(\"div\",{className:\"remark-code-title\",children:\"delete_03_test.go-01\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"import\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/brianvoe/gofakeit/v6\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"github.com/stretchr/testify/assert\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"gorm.io/gorm\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"gorm.io/gorm/clause\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token string\",children:'\"testing\"'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"TestReturningDataFromDeletedRows\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"testing\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"T\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"MustGormMySQLGormExampleDBConnectionPool\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"MigrationEntities\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"User\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"CreateUserData\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// \\uBAA8\\uB4E0 \\uCEEC\\uB7FC\\uC744 \\uBC18\\uD658\\uD558\\uAE30\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"var\"}),\" users \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),`User\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Clauses\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clause\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Returning\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"role = ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"admin\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"users\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// DELETE FROM `users` WHERE role = \"admin\" RETURNING *'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// users =\u003e []User{{ID: 1, Name: \"jinzhu\", Role: \"admin\", Salary: 100}, {ID: 2, Name: \"jinzhu.2\", Role: \"admin\", Salary: 1000}}'}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// \\uC9C0\\uC815\\uB41C \\uCEEC\\uB7FC\\uC744 \\uBC18\\uD658\\uD558\\uAC8C \\uD558\\uAE30\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Clauses\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"clause\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Returning\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Columns\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"clause\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Column\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"name\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Name\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"salary\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"role = ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token string\",children:'\"admin\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"users\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// DELETE FROM `users` WHERE role = \"admin\" RETURNING `name`, `salary`'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// users =\u003e []User{{ID: 0, Name: \"jinzhu\", Role: \"\", Salary: 100}, {ID: 0, Name: \"jinzhu.2\", Role: \"\", Salary: 1000}}'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]})]})}),(0,n.jsxs)(e.h3,{id:\"soft-delete\",children:[(0,n.jsx)(e.a,{\"aria-hidden\":\"true\",href:\"#soft-delete\",tabIndex:\"-1\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Soft Delete\"]}),(0,n.jsx)(e.p,{children:\"gorm\\uC740 gorm.DeletedAt \\uD544\\uB4DC\\uB97C \\uC0AC\\uC6A9\\uD574 soft delete(\\uC2E4\\uC81C \\uB370\\uC774\\uD130\\uB294 \\uC0AD\\uC81C\\uD558\\uC9C0 \\uC54A\\uACE0 \\uD50C\\uB798\\uADF8\\uB85C \\uC0AD\\uC81C\\uB428 \\uD45C\\uC2DC)\\uB97C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,n.jsx)(e.p,{children:\"\\uC774 \\uBAA8\\uB378\\uC744 gorm entity\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD558\\uBA74 \\uC790\\uB3D9\\uC73C\\uB85C \\uC801\\uC6A9\\uB41C\\uB2E4.\"}),(0,n.jsx)(e.p,{children:\"soft delete\\uAC00 \\uC801\\uC6A9\\uB418\\uBA74 Delete\\uB97C \\uC2E4\\uD589\\uD588\\uC744 \\uB54C \\uB808\\uCF54\\uB4DC\\uB294 database\\uC5D0\\uC11C \\uC0AD\\uC81C\\uB418\\uC9C0 \\uC54A\\uACE0 deletedAt \\uC758 \\uAC12\\uC744 \\uD604\\uC7AC \\uC2DC\\uAC04\\uC73C\\uB85C \\uC5C5\\uB370\\uC774\\uD2B8\\uD55C\\uB2E4.\"}),(0,n.jsx)(e.p,{children:\"\\uC774\\uB807\\uAC8C \\uD45C\\uC2DC\\uB41C \\uB370\\uC774\\uD130\\uB294 gorm\\uC73C\\uB85C query\\uD560 \\uB54C \\uC77C\\uBC18\\uC801\\uC778 \\uBC29\\uBC95\\uC73C\\uB85C\\uB294 \\uAC80\\uC0C9\\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4.\"}),(0,n.jsx)(\"div\",{className:\"remark-code-title\",children:\"delete_03_test.go-02\"}),(0,n.jsx)(e.pre,{className:\"language-go\",children:(0,n.jsxs)(e.code,{className:\"language-go code-highlight\",children:[(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"TestSoftDelete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"testing\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"T\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tdb \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"MustGormMySQLGormExampleDBConnectionPool\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//softdelete \\uB97C \\uC0AC\\uC6A9\\uD558\\uB824\\uBA74 gorm.DeletedAt \\uD544\\uB4DC\\uAC00 \\uC788\\uC5B4\\uC57C \\uD55C\\uB2E4.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//gorm.Model\\uC5D0\\uB3C4 \\uD3EC\\uD568\\uB418\\uC5B4 \\uC788\\uB2E4.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" UserGormModel \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tgorm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`Model\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tID   \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tAge  \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tName \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"type\"}),\" UserDeletedAt \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"struct\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tID      \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tAge     \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tDeleted gorm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),`DeletedAt\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tName    \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"string\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"    \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//seqpicker\\uB294 \\uC785\\uB825\\uB41C \\uAC12\\uB4E4\\uC744 PickNext\\uD560 \\uB54C\\uB9C8\\uB2E4 \\uC21C\\uCC28\\uC801\\uC73C\\uB85C \\uBC18\\uD658\\uD55C\\uB2E4.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tseqpicker \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token function\",children:\"NewSeqPicker\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"20\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"30\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"MigrationEntities\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"UserDeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tgenUser \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tgen2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" NewDummyDataGenerator\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),\"UserDeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token number\",children:\"60\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\tgen2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"GenP\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token keyword\",children:\"func\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token boolean\",children:\"_\"}),\" \",(0,n.jsx)(e.span,{className:\"token builtin\",children:\"int\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" user1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"*\"}),\"UserDeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tuser1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"ID \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"0\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tuser1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Name \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" gofakeit\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Name\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tuser1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Age \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" seqpicker\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"PickNext\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\tuser1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Deleted \",(0,n.jsx)(e.span,{className:\"token operator\",children:\"=\"}),\" gorm\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"DeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"Valid\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token boolean\",children:\"false\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token function\",children:\"genUser\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuser \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" UserDeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),\"ID\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"3\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// user's ID is `111`\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),\" \",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//\\uC0AD\\uC81C\\uD558\\uC9C0 \\uC54A\\uACE0 deleted \\uD544\\uB4DC\\uB97C \\uD604\\uC7AC \\uC2DC\\uAC04\\uAC12\\uC73C\\uB85C \\uC5C5\\uB370\\uC774\\uD2B8\\uD55C\\uB2E4.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// UPDATE users SET deleted_at=\"2013-10-29 10:23\" WHERE id = 111;'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuser1 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"UserDeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Batch Delete \\uC0AD\\uC81C\\uD558\\uC9C0 \\uC54A\\uACE0 deleted \\uD544\\uB4DC\\uB97C \\uD604\\uC7AC \\uC2DC\\uAC04\\uAC12\\uC73C\\uB85C \\uC5C5\\uB370\\uC774\\uD2B8\\uD55C\\uB2E4.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"age = ?\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" \",(0,n.jsx)(e.span,{className:\"token number\",children:\"10\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user1\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:'// UPDATE users SET deleted_at=\"2013-10-29 10:23\" WHERE age = 10;'}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuser2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"UserDeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// softdelete \\uB41C \\uCEEC\\uB7FC\\uC740 \\uCFFC\\uB9AC\\uC5D0\\uC11C \\uC81C\\uC678\\uB41C\\uB2E4.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx3 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"age = 20\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Find\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"user2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// SELECT * FROM users WHERE age = 20 AND deleted_at IS NULL;\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx3\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuserdel \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"UserDeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//soft deleted \\uB808\\uCF54\\uB4DC \\uCC3E\\uAE30\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// Unscoped\\uB97C \\uC0AC\\uC6A9\\uD558\\uBA74 soft deleted \\uC0C1\\uD0DC\\uC778 row\\uB3C4 \\uCC3E\\uC744 \\uC218 \\uC788\\uB2E4.\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx4 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Unscoped\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"age = 30\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Find\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"userdel\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// SELECT * FROM users WHERE age = 20;\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx4\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tuserdel2 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" \",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"[\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"]\"}),\"UserDeletedAt\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"{\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"//Unscoped\\uB97C \\uC0AC\\uC6A9\\uD558\\uBA74 softdelete \\uCFFC\\uB9AC\\uB3C4 hard DELETE \\uD560 \\uC218 \\uC788\\uB2E4\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\ttx5 \",(0,n.jsx)(e.span,{className:\"token operator\",children:\":=\"}),\" db\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Unscoped\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Where\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token string\",children:'\"age = 30\"'}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"Delete\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),(0,n.jsx)(e.span,{className:\"token operator\",children:\"\u0026\"}),\"userdel2\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\t\",(0,n.jsx)(e.span,{className:\"token comment\",children:\"// DELETE FROM orders WHERE id=10;\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[\"\tassert\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),(0,n.jsx)(e.span,{className:\"token function\",children:\"NoError\"}),(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"(\"}),\"t\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\",\"}),\" tx5\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\".\"}),\"Error\",(0,n.jsx)(e.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,n.jsxs)(e.span,{className:\"code-line\",children:[(0,n.jsx)(e.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,n.jsx)(e.span,{className:\"code-line\",children:`\n`})]})})]})}}var b=E;return D;})();\n;return Component;","toc":[{"value":"1개 레코드 삭제하기 (Delete a Record)","url":"#1개-레코드-삭제하기-delete-a-record","depth":3},{"value":"pk로 삭제하기 (Delete with primary key)","url":"#pk로-삭제하기-delete-with-primary-key","depth":3},{"value":"Delete Hooks","url":"#delete-hooks","depth":3},{"value":"Batch Update","url":"#batch-update","depth":2},{"value":"Global Delete 차단 (Block Global Delete)","url":"#global-delete-차단-block-global-delete","depth":3},{"value":"row들을 삭제한 이후 data 반환 받기 ( Returning Data From Deleted Rows )","url":"#row들을-삭제한-이후-data-반환-받기--returning-data-from-deleted-rows-","depth":3},{"value":"Soft Delete","url":"#soft-delete","depth":3}],"frontMatter":{"readingTime":{"text":"12 min read","minutes":11.735,"time":704100,"words":2347},"slug":"gorm-delete","fileName":"gorm-delete.mdx","title":"gorm-delete","date":"2023-11-23T22:11:33.000Z","lastmod":"2023-11-26","tags":["go","orm"],"draft":false,"summary":"","layout":"PostSimple","canonicalUrl":"https://demian9k.github.io/blog/gorm-delete/"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.155,"time":9300,"words":31},"slug":["default"],"fileName":"default.md","name":"demian11k","avatar":"/static/images/avatar.png","email":"demian11k@gmail.com","github":"https://github.com/demian9k","date":null}],"prev":{"title":"gorm-update","date":"2023-11-22T22:11:33.000Z","lastmod":"2023-11-26","tags":["go","orm"],"draft":false,"summary":"","layout":"PostSimple","canonicalUrl":"https://demian9k.github.io/blog/gorm-update/","slug":"gorm-update"},"next":null},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["gorm-delete"]},"buildId":"otfPwKwSsy3CYkkcjSJd6","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>