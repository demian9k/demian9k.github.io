<!DOCTYPE html><html lang="en" class="scroll-smooth"><head><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if("system"===e||(!e&&true)){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else if(e) d.add(e)}catch(e){}}()</script><meta content="width=device-width, initial-scale=1" name="viewport"/><title>prometheus johoon</title><meta name="robots" content="follow, index"/><meta name="description" content=""/><meta property="og:url" content="https://demian9k.github.io/blog/prometheus_johoon"/><meta property="og:type" content="article"/><meta property="og:site_name" content="demian11k studylog"/><meta property="og:description" content=""/><meta property="og:title" content="prometheus johoon"/><meta property="og:image" content="https://demian9k.github.io/static/images/twitter-card.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site"/><meta name="twitter:title" content="prometheus johoon"/><meta name="twitter:description" content=""/><meta name="twitter:image" content="https://demian9k.github.io/static/images/twitter-card.png"/><link rel="canonical" href="https://demian9k.github.io/blog/prometheus_johoon"/><meta property="article:published_time" content="2023-05-31T03:03:00.000Z"/><meta property="article:modified_time" content="2023-05-31T00:00:00.000Z"/><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://demian9k.github.io/blog/prometheus_johoon"
  },
  "headline": "prometheus johoon",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://demian9k.github.io/static/images/twitter-card.png"
    }
  ],
  "datePublished": "2023-05-31T03:03:00.000Z",
  "dateModified": "2023-05-31T00:00:00.000Z",
  "author": {
    "@type": "Person",
    "name": "demian11k"
  },
  "publisher": {
    "@type": "Organization",
    "name": "demian11k",
    "logo": {
      "@type": "ImageObject",
      "url": "https://demian9k.github.io/static/images/logo.png"
    }
  },
  "description": ""
}</script><meta name="next-head-count" content="21"/><link rel="apple-touch-icon" sizes="76x76" href="/static/favicons/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/static/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/favicon-16x16.png"/><link rel="manifest" href="/static/favicons/site.webmanifest"/><link rel="mask-icon" href="/static/favicons/safari-pinned-tab.svg" color="#5bbad5"/><meta name="msapplication-TileColor" content="#000000"/><meta name="theme-color" media="(prefers-color-scheme: light)" content="#fff"/><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"/><link rel="alternate" type="application/rss+xml" href="/feed.xml"/><link rel="preload" href="/_next/static/css/9da9539fac7f1ee9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9da9539fac7f1ee9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-1667cddafac2eea3.js" defer=""></script><script src="/_next/static/chunks/main-bfc1a3b6dd286443.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e097d8b875e64e46.js" defer=""></script><script src="/_next/static/chunks/140-77b8ab5a870d524b.js" defer=""></script><script src="/_next/static/chunks/574-40cb695d6b511631.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slug%5D-48fd063b43fdbe6a.js" defer=""></script><script src="/_next/static/_epZdIX6LUAs-N565XCV9/_buildManifest.js" defer=""></script><script src="/_next/static/_epZdIX6LUAs-N565XCV9/_ssgManifest.js" defer=""></script><script src="/_next/static/_epZdIX6LUAs-N565XCV9/_middlewareManifest.js" defer=""></script></head><body class="bg-white text-black antialiased dark:bg-gray-900 dark:text-white"><div id="__next" data-reactroot=""><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="flex h-screen flex-col justify-between"><header class="flex items-center justify-between py-10"><div><a aria-label="demian11k.studylog" href="/"><div class="flex items-center justify-between"><div class="mr-3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2740%27%20height=%2740%27/%3e"/></span><img alt="A" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="rounded-full object-cover object-center md:h-36 lg:h-48" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="A" srcSet="/_next/static/media/demian_avatar_logo.c12b9855.png?imwidth=48 1x, /_next/static/media/demian_avatar_logo.c12b9855.png?imwidth=96 2x" src="/_next/static/media/demian_avatar_logo.c12b9855.png?imwidth=96" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="rounded-full object-cover object-center md:h-36 lg:h-48" loading="lazy"/></noscript></span></div><div class="hidden h-6 text-2xl font-semibold sm:block">demian11k.studylog</div></div></a></div><div class="flex items-center text-base leading-5"><div class="hidden sm:block"><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/blog">Blog</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/tags">Tags</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/projects">Projects</a><a class="p-1 font-medium text-gray-900 dark:text-gray-100 sm:p-4" href="/about">About</a></div><button aria-label="Toggle Dark Mode" type="button" class="ml-1 mr-1 h-8 w-8 rounded p-1 sm:ml-4"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg></button><div class="sm:hidden"><button type="button" class="ml-1 mr-1 h-8 w-8 rounded py-1" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg></button><div class="fixed top-0 left-0 z-10 h-full w-full transform bg-gray-200 opacity-95 duration-300 ease-in-out dark:bg-gray-800 translate-x-full"><div class="flex justify-end"><button type="button" class="mr-5 mt-11 h-8 w-8 rounded" aria-label="Toggle Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="text-gray-900 dark:text-gray-100"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><nav class="fixed mt-8 h-full"><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/blog">Blog</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/tags">Tags</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/projects">Projects</a></div><div class="px-12 py-4"><a class="text-2xl font-bold tracking-widest text-gray-900 dark:text-gray-100" href="/about">About</a></div></nav></div></div></div></header><main class="mb-auto"><div class="mx-auto max-w-3xl px-4 sm:px-6 xl:max-w-5xl xl:px-0"><div class="fixed right-8 bottom-8 hidden flex-col gap-3 md:hidden"><button aria-label="Scroll To Top" type="button" class="rounded-full bg-gray-200 p-2 text-gray-500 transition-all hover:bg-gray-300 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"><svg class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z" clip-rule="evenodd"></path></svg></button></div><article><div><header><div class="space-y-1 border-b border-gray-200 pb-10 text-center dark:border-gray-700"><dl><div><dt class="sr-only">Published on</dt><dd class="text-base font-medium leading-6 text-gray-500 dark:text-gray-400"><time dateTime="2023-05-31T03:03:00.000Z">May 31, 2023</time></dd></div></dl><div><h1 class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-5xl md:leading-14">prometheus johoon</h1></div></div></header><div class="divide-y divide-gray-200 pb-8 dark:divide-gray-700 xl:divide-y-0 " style="grid-template-rows:auto 1fr"><div class="divide-y divide-gray-200 dark:divide-gray-700 xl:col-span-3 xl:row-span-2 xl:pb-0"><div class="prose max-w-none pt-10 pb-8 dark:prose-dark"><p>k8s 노드는 kubelet을 통해 파드를 관리하고 CPU/memory 등 메트릭을 수집하기 위해 kubelet 내부의 cAdvidsor를 사용한다. cAdvisor는 컨테이너 메트릭 수집 도구로 컨테이너의 메트릭 정보를 수집해 가공한 후 kubelet에 전달하는 역할을 한다.</p><p>가장 기본적으로 cAdvisor가 수집하고, kublet이 가진 이 데이터를 Metrics-Server에 집계하여 k8s dashboard로 시각화하는 방법이 있지만</p><p>metric-server는 집계한 데이터를 메모리에만 저장하므로 영구적으로 보존되지 않는다.</p><p>기본적인 방법을 프로메테우스르 사용해 좀 더 쓸만한 형태로 바꾸려면</p><p>cAdvisor로 수집하고 프로메테우스에서 모아 TSDB에 저장하고 그라파나로 사용할 수 있는 방법이 있다.</p><h4 id="프로메테우스-역할"><a href="#프로메테우스-역할" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>프로메테우스 역할</h4><ol><li>node exporter 등 공개된 메트릭을 수집</li><li>수집된 ts 데이터를 저장하는 tsdb</li><li>저장된 데이터 질의 및 수집 대상 확인(ui)</li></ol><h4 id="node-exporter"><a href="#node-exporter" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>node exporter</h4><p>node의 시스템 메트릭 정보를 http api로 제공한다. 설치된 노드에서 특정 파일들을 읽고, 프로메테우스 서버가 수집할 수 있는 메트릭으로 변환한 후 이것을 http로 공개한다. 공개된 내용은 프로메테우스 서버가 수집해간다.</p><h4 id="kube-state-metrics"><a href="#kube-state-metrics" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>kube-state-metrics</h4><p>api 서버로 k8s 클러스터의 여러 메트릭 데이터를 수집한 후 이를 pm 서버가 수집할 수 있는 메트릭 데이터로 변환해 공개한다.</p><h4 id="alertmanager"><a href="#alertmanager" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>alertmanager</h4><p>alert 규칙(rule)을 프로메테우스에 설정하여 해당 rule에 따라 이벤트가 발생하면 alert을 대상에게 전달한다.</p><h4 id="pushgateway"><a href="#pushgateway" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>pushgateway</h4><p>배치와 스케줄 작업 시 수행되는 일회성 작업들의 상태를 저장, 집계하여 프로메테우스가 주기적으로 가져갈 수 있도록 한다. 외부망에서 접근할 수 없는 내부시스템의 메트릭을 프록시 형태로 제공하는 용도로 사용된다.</p><h4 id="k8s-환경에서-수집-대상은-3가지다"><a href="#k8s-환경에서-수집-대상은-3가지다" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>k8s 환경에서 수집 대상은 3가지다.</h4><ol><li>container (cAdvisor)</li><li>k8s Node(node-exporter)</li></ol><ul><li>-&gt; &quot;/metrics&quot; 로 http api 로 제공된다.</li></ul><ol start="3"><li>클러스터 메타데이터(kube-state-metrics)</li></ol><ul><li>-&gt; &quot;/metrics&quot; 로 http api 로 제공된다.</li></ul><h3 id="k8s-환경에서의-서비스-디스커버리"><a href="#k8s-환경에서의-서비스-디스커버리" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>k8s 환경에서의 서비스 디스커버리</h3><ol><li>프로메테우스 서버는 컨피그맵에 기록된 내용을 바탕으로 대상을 읽어옵니다.</li><li>읽어온 대상에 대한 메트릭을 가져오기 위해 API서버에 정보를 요청합니다</li><li>요청을 통해 알아온 경로로 메트릭 데이터를 수집합니다.</li></ol><p>프로메테우스 서버가 API서버가 주기적으로 데이터를 주고받아 수집 대상을 업데이트하고 수집 대상에서 공개되는 메트릭을 자동으로 수집합니다.</p><p>수집하는 방법 2가지</p><ul><li>k8s api 서버에 직접 연결하여 메트릭을 수집하는 cAdvisor,</li><li>API 서버가 알려준 경로로 메트릭을 수집하는 agent(exporter)</li></ul><h4 id="cadvisor"><a href="#cadvisor" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>cAdvisor</h4><p>cAdvisor의 메트릭은 container라는 이름으로 시작한다.</p><p>Graph 메뉴의 쿼리 입력기에서 Execute를 누르면 실행된다.</p><p>실행시간(LoadTime), 수집된 데이터로 지정된 second graph(Resolution) 수집된 결과 갯수(TotaltimeSeries)</p><p>PromQL</p><div class="relative"><pre><code class="code-highlight language-Bash"><span class="code-line"><span class="token comment">#label이 nginx인 컨테이너의 메모리 사용량 검색하기</span>
</span><span class="code-line">container_memory_usage_bytes<span class="token punctuation">{</span>container<span class="token operator">=</span><span class="token string">&quot;nginx&quot;</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">#</span>
</span><span class="code-line">kubectl create deployment nginx --image<span class="token operator">=</span>nginx
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">#배포 이후 ConfigMap에 수집 대상이 지정되어 위 쿼리에 결과가 보인다.</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">#컨피그맵 확인</span>
</span><span class="code-line">kubectl get configmap prometheus-server -o yaml <span class="token operator">|</span> <span class="token function">nl</span>
</span></code></pre></div><h4 id="exporter"><a href="#exporter" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Exporter</h4><p>Service Discovery를 통해 수집은 자동으로 되지만 익스포터는 사전작업 2가지를 먼저 해야한다.</p><ol><li>API 서버에 등록돼 경로를 알 수 있게 한다.</li><li>Exporter가 데이터를 Prometheus type으로 expose 한다.</li></ol><p>nginx-status-annot</p><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> apps/v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Deployment
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> nginx
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">selector</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">matchLabels</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">app</span><span class="token punctuation">:</span> nginx
</span><span class="code-line">  <span class="token atrule key">template</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">labels</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">app</span><span class="token punctuation">:</span> nginx
</span><span class="code-line">        <span class="token comment"># 프로메테우스 서버가 배포된 애플리케이션을 찾고 메트릭을 수집하게 하는 annotation 설정</span>
</span><span class="code-line">        <span class="token comment"># API 서버에 등록하는 것으로, 이 설정은 expose 하지 않는다.</span>
</span><span class="code-line">      <span class="token atrule key">annotations</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">prometheus.io/port</span><span class="token punctuation">:</span> <span class="token string">&#x27;80&#x27;</span>
</span><span class="code-line">        <span class="token atrule key">prometheus.io/scrape</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
</span><span class="code-line">    <span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">containers</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> nginx
</span><span class="code-line">          <span class="token atrule key">image</span><span class="token punctuation">:</span> sysnet4admin/nginx<span class="token punctuation">-</span>status
</span><span class="code-line">          <span class="token atrule key">ports</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</span></code></pre></div><div class="relative"><pre><code class="code-highlight language-yaml"><span class="code-line"><span class="token atrule key">apiVersion</span><span class="token punctuation">:</span> apps/v1
</span><span class="code-line"><span class="token atrule key">kind</span><span class="token punctuation">:</span> Deployment
</span><span class="code-line"><span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">name</span><span class="token punctuation">:</span> nginx
</span><span class="code-line"><span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">  <span class="token atrule key">selector</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">matchLabels</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">app</span><span class="token punctuation">:</span> nginx
</span><span class="code-line">  <span class="token atrule key">template</span><span class="token punctuation">:</span>
</span><span class="code-line">    <span class="token atrule key">metadata</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">labels</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">app</span><span class="token punctuation">:</span> nginx
</span><span class="code-line">      <span class="token atrule key">annotations</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token atrule key">prometheus.io/port</span><span class="token punctuation">:</span> <span class="token string">&#x27;9113&#x27;</span>
</span><span class="code-line">        <span class="token atrule key">prometheus.io/scrape</span><span class="token punctuation">:</span> <span class="token string">&#x27;true&#x27;</span>
</span><span class="code-line">    <span class="token atrule key">spec</span><span class="token punctuation">:</span>
</span><span class="code-line">      <span class="token atrule key">containers</span><span class="token punctuation">:</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> nginx
</span><span class="code-line">          <span class="token atrule key">image</span><span class="token punctuation">:</span> sysnet4admin/nginx<span class="token punctuation">-</span>status
</span><span class="code-line">          <span class="token atrule key">ports</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</span><span class="code-line">        <span class="token comment"># nginx-exporter container를 sidecar로 pod 내에 설치한다.</span>
</span><span class="code-line">        <span class="token comment"># 이 container가 scrape_uri로 접속하여 nginx의 status를 scrape한다.</span>
</span><span class="code-line">        <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>exporter
</span><span class="code-line">          <span class="token atrule key">image</span><span class="token punctuation">:</span> nginx/nginx<span class="token punctuation">-</span>prometheus<span class="token punctuation">-</span>exporter<span class="token punctuation">:</span>0.8.0
</span><span class="code-line">          <span class="token atrule key">env</span><span class="token punctuation">:</span>
</span><span class="code-line">            <span class="token punctuation">-</span> <span class="token atrule key">name</span><span class="token punctuation">:</span> SCRAPE_URI
</span><span class="code-line">              <span class="token atrule key">value</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>80/stub_status
</span></code></pre></div><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/prometheus/node_exporter">https://github.com/prometheus/node_exporter</a></p><p>node exporter는 /proc, /sys 메트릭으로 노출하여 구현되어 있다. 메트릭 이름은 node_ 로 시작한다.</p><p>/proc은 리눅스에서 동작중인 프로세스의 정보를 filesystem 형태로 연결한 디렉터리다. /sys 는 I/O 장치(저장 장치, 네트워크, 입출력 장치) 등을 OS에서 사용할 수 있도록 연결된 디렉터리다.</p><h4 id="kube-state-metric"><a href="#kube-state-metric" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>kube state metric</h4><p>kube-state-metrics(KSM)는 쿠버네티스 API 서버를 리스닝하여 오브젝트의 상태에 대한 메트릭을 생성하는 간단한 서비스이다. 개별 쿠버네티스 구성 요소의 상태가 아니라 배포, 노드 및 파드와 같은 내부의 다양한 오브젝트의 상태에 중점을 둔다.</p><p>프로메테우스가 받아들일 수 있는 유형으로 변환하여 /metrics 주소로 공개한다.</p><p>각 노드의 특정 디렉터리를 마운트해서 사용하지 않고 이미 API 서버에 모인 값들을 수집하는 것이 Node Exporter와 다른점이다.</p><p>메트릭 이름은 kube_ 로 시작한다.</p><h4 id="메트릭"><a href="#메트릭" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>메트릭</h4><p>메트릭 종류</p><p><strong>카운터</strong> 누적된값을 표현, 값을 구간별로 변화율을 파악해 해당 값이 어느 정도 추세로 증가하는지 확인할 수 있고 이벤트나 오류 등이 급증하는 구간을 파악하는 데 적합함</p><p>카운터 값 메트릭 node_cpu_seconds_total kube_pod_container_status_restarts_total</p><p><strong>게이지</strong> 특정 시점의 값을 표현, 게이지는 시점별로 증가나 감소를 모두 표현하며, CPU온도나 메모리 사용량 등은 누적된 값(카운터)가 필요하지 않고 조회하는 순간 값이 중요하므로 게이지 타입을 사용한다.</p><p>게이지 값 메트릭 접미사 _bytes _created</p><p><strong>히스토그램</strong> 사전에 미리 정의한 구간 안에 있는 메트릭 값의 빈도를 측정 익스포터 구현 단계에서 구간(버킷)을 정의한다.</p><p><strong>유스케이스</strong> http 요청의 응답 시간에 맞는 버킷이 값을 추가하고 이벤트 횟수를 저장하는 데 사용할 수 있다.</p><p><strong>서머리</strong> 히스토그램과 유사하게 구간 내 메트릭 값의 빈도를 측정한다. 히스토그램과 차이점은 구간이 지정되는 것이 아니라 프로메테우스의 로직에 따라 0~1 구간이 정해져 있다.</p><p>메트릭 값 타입은 아래처럼 요청했을 때 결과에서 comment으로 확인할 수 있다.</p><div class="relative"><pre><code class="code-highlight language-bash"><span class="code-line"><span class="token function">curl</span> -s <span class="token number">192.168</span>.1.10:9100/metrics <span class="token operator">|</span> <span class="token function">nl</span> <span class="token operator">|</span> <span class="token function">grep</span> node_memory_MemAvailable_bytes
</span></code></pre></div></div></div><div id="comment"></div><footer><div class="flex flex-col text-sm font-medium sm:flex-row sm:justify-between sm:text-base"><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/prometheus">← <!-- -->prometheus</a></div><div class="pt-4 xl:pt-8"><a class="text-primary-500 hover:text-primary-600 dark:hover:text-primary-400" href="/blog/k8s_manifest_Volume">K8S manifest - Volume<!-- --> →</a></div></div></footer></div></div></article></div></main><footer><div class="mt-16 flex flex-col items-center"><div class="mb-3 flex space-x-4"><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="mailto:demian11k@gmail.com"><span class="sr-only">mail</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M2.003 5.884 10 9.882l7.997-3.998A2 2 0 0 0 16 4H4a2 2 0 0 0-1.997 1.884z"></path><path d="m18 8.118-8 4-8-4V14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8.118z"></path></svg></a><a class="text-sm text-gray-500 transition hover:text-gray-600" target="_blank" rel="noopener noreferrer" href="https://github.com/demian9k"><span class="sr-only">github</span><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="fill-current text-gray-700 hover:text-blue-500 dark:text-gray-200 dark:hover:text-blue-400 h-6 w-6"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a></div><div class="mb-2 flex space-x-2 text-sm text-gray-500 dark:text-gray-400"><div>demian11k</div><div> • </div><div>© 2023</div><div> • </div><a href="/">demian11k studylog</a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"mdxSource":"var Component=(()=\u003e{var o=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var i=a=\u003el(a,\"__esModule\",{value:!0});var u=(a,s)=\u003e()=\u003e(s||a((s={exports:{}}).exports,s),s.exports),k=(a,s)=\u003e{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},N=(a,s,c)=\u003e{if(s\u0026\u0026typeof s==\"object\"||typeof s==\"function\")for(let n of p(s))!m.call(a,n)\u0026\u0026n!==\"default\"\u0026\u0026l(a,n,{get:()=\u003es[n],enumerable:!(c=d(s,n))||c.enumerable});return a},g=a=\u003eN(i(l(a!=null?o(h(a)):{},\"default\",a\u0026\u0026a.__esModule\u0026\u0026\"default\"in a?{get:()=\u003ea.default,enumerable:!0}:{value:a,enumerable:!0})),a);var r=u((v,t)=\u003e{t.exports=_jsx_runtime});var _={};k(_,{default:()=\u003eb,frontmatter:()=\u003ey});var e=g(r()),y={title:\"prometheus johoon\",date:new Date(168550218e4),lastmod:\"2023-05-31\",tags:[\"alert\"],draft:!1,summary:\"\",layout:\"PostSimple\"};function x(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({p:\"p\",h4:\"h4\",a:\"a\",span:\"span\",ol:\"ol\",li:\"li\",ul:\"ul\",h3:\"h3\",pre:\"pre\",code:\"code\",strong:\"strong\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n.p,{children:\"k8s \\uB178\\uB4DC\\uB294 kubelet\\uC744 \\uD1B5\\uD574 \\uD30C\\uB4DC\\uB97C \\uAD00\\uB9AC\\uD558\\uACE0 CPU/memory \\uB4F1 \\uBA54\\uD2B8\\uB9AD\\uC744 \\uC218\\uC9D1\\uD558\\uAE30 \\uC704\\uD574 kubelet \\uB0B4\\uBD80\\uC758 cAdvidsor\\uB97C \\uC0AC\\uC6A9\\uD55C\\uB2E4. cAdvisor\\uB294 \\uCEE8\\uD14C\\uC774\\uB108 \\uBA54\\uD2B8\\uB9AD \\uC218\\uC9D1 \\uB3C4\\uAD6C\\uB85C \\uCEE8\\uD14C\\uC774\\uB108\\uC758 \\uBA54\\uD2B8\\uB9AD \\uC815\\uBCF4\\uB97C \\uC218\\uC9D1\\uD574 \\uAC00\\uACF5\\uD55C \\uD6C4 kubelet\\uC5D0 \\uC804\\uB2EC\\uD558\\uB294 \\uC5ED\\uD560\\uC744 \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uAC00\\uC7A5 \\uAE30\\uBCF8\\uC801\\uC73C\\uB85C cAdvisor\\uAC00 \\uC218\\uC9D1\\uD558\\uACE0, kublet\\uC774 \\uAC00\\uC9C4 \\uC774 \\uB370\\uC774\\uD130\\uB97C Metrics-Server\\uC5D0 \\uC9D1\\uACC4\\uD558\\uC5EC k8s dashboard\\uB85C \\uC2DC\\uAC01\\uD654\\uD558\\uB294 \\uBC29\\uBC95\\uC774 \\uC788\\uC9C0\\uB9CC\"}),(0,e.jsx)(n.p,{children:\"metric-server\\uB294 \\uC9D1\\uACC4\\uD55C \\uB370\\uC774\\uD130\\uB97C \\uBA54\\uBAA8\\uB9AC\\uC5D0\\uB9CC \\uC800\\uC7A5\\uD558\\uBBC0\\uB85C \\uC601\\uAD6C\\uC801\\uC73C\\uB85C \\uBCF4\\uC874\\uB418\\uC9C0 \\uC54A\\uB294\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uAE30\\uBCF8\\uC801\\uC778 \\uBC29\\uBC95\\uC744 \\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4\\uB974 \\uC0AC\\uC6A9\\uD574 \\uC880 \\uB354 \\uC4F8\\uB9CC\\uD55C \\uD615\\uD0DC\\uB85C \\uBC14\\uAFB8\\uB824\\uBA74\"}),(0,e.jsx)(n.p,{children:\"cAdvisor\\uB85C \\uC218\\uC9D1\\uD558\\uACE0 \\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4\\uC5D0\\uC11C \\uBAA8\\uC544 TSDB\\uC5D0 \\uC800\\uC7A5\\uD558\\uACE0 \\uADF8\\uB77C\\uD30C\\uB098\\uB85C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB294 \\uBC29\\uBC95\\uC774 \\uC788\\uB2E4.\"}),(0,e.jsxs)(n.h4,{id:\"\\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4-\\uC5ED\\uD560\",children:[(0,e.jsx)(n.a,{href:\"#\\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4-\\uC5ED\\uD560\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4 \\uC5ED\\uD560\"]}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:\"node exporter \\uB4F1 \\uACF5\\uAC1C\\uB41C \\uBA54\\uD2B8\\uB9AD\\uC744 \\uC218\\uC9D1\"}),(0,e.jsx)(n.li,{children:\"\\uC218\\uC9D1\\uB41C ts \\uB370\\uC774\\uD130\\uB97C \\uC800\\uC7A5\\uD558\\uB294 tsdb\"}),(0,e.jsx)(n.li,{children:\"\\uC800\\uC7A5\\uB41C \\uB370\\uC774\\uD130 \\uC9C8\\uC758 \\uBC0F \\uC218\\uC9D1 \\uB300\\uC0C1 \\uD655\\uC778(ui)\"})]}),(0,e.jsxs)(n.h4,{id:\"node-exporter\",children:[(0,e.jsx)(n.a,{href:\"#node-exporter\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"node exporter\"]}),(0,e.jsx)(n.p,{children:\"node\\uC758 \\uC2DC\\uC2A4\\uD15C \\uBA54\\uD2B8\\uB9AD \\uC815\\uBCF4\\uB97C http api\\uB85C \\uC81C\\uACF5\\uD55C\\uB2E4. \\uC124\\uCE58\\uB41C \\uB178\\uB4DC\\uC5D0\\uC11C \\uD2B9\\uC815 \\uD30C\\uC77C\\uB4E4\\uC744 \\uC77D\\uACE0, \\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4 \\uC11C\\uBC84\\uAC00 \\uC218\\uC9D1\\uD560 \\uC218 \\uC788\\uB294 \\uBA54\\uD2B8\\uB9AD\\uC73C\\uB85C \\uBCC0\\uD658\\uD55C \\uD6C4 \\uC774\\uAC83\\uC744 http\\uB85C \\uACF5\\uAC1C\\uD55C\\uB2E4. \\uACF5\\uAC1C\\uB41C \\uB0B4\\uC6A9\\uC740 \\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4 \\uC11C\\uBC84\\uAC00 \\uC218\\uC9D1\\uD574\\uAC04\\uB2E4.\"}),(0,e.jsxs)(n.h4,{id:\"kube-state-metrics\",children:[(0,e.jsx)(n.a,{href:\"#kube-state-metrics\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"kube-state-metrics\"]}),(0,e.jsx)(n.p,{children:\"api \\uC11C\\uBC84\\uB85C k8s \\uD074\\uB7EC\\uC2A4\\uD130\\uC758 \\uC5EC\\uB7EC \\uBA54\\uD2B8\\uB9AD \\uB370\\uC774\\uD130\\uB97C \\uC218\\uC9D1\\uD55C \\uD6C4 \\uC774\\uB97C pm \\uC11C\\uBC84\\uAC00 \\uC218\\uC9D1\\uD560 \\uC218 \\uC788\\uB294 \\uBA54\\uD2B8\\uB9AD \\uB370\\uC774\\uD130\\uB85C \\uBCC0\\uD658\\uD574 \\uACF5\\uAC1C\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.h4,{id:\"alertmanager\",children:[(0,e.jsx)(n.a,{href:\"#alertmanager\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"alertmanager\"]}),(0,e.jsx)(n.p,{children:\"alert \\uADDC\\uCE59(rule)\\uC744 \\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4\\uC5D0 \\uC124\\uC815\\uD558\\uC5EC \\uD574\\uB2F9 rule\\uC5D0 \\uB530\\uB77C \\uC774\\uBCA4\\uD2B8\\uAC00 \\uBC1C\\uC0DD\\uD558\\uBA74 alert\\uC744 \\uB300\\uC0C1\\uC5D0\\uAC8C \\uC804\\uB2EC\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.h4,{id:\"pushgateway\",children:[(0,e.jsx)(n.a,{href:\"#pushgateway\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"pushgateway\"]}),(0,e.jsx)(n.p,{children:\"\\uBC30\\uCE58\\uC640 \\uC2A4\\uCF00\\uC904 \\uC791\\uC5C5 \\uC2DC \\uC218\\uD589\\uB418\\uB294 \\uC77C\\uD68C\\uC131 \\uC791\\uC5C5\\uB4E4\\uC758 \\uC0C1\\uD0DC\\uB97C \\uC800\\uC7A5, \\uC9D1\\uACC4\\uD558\\uC5EC \\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4\\uAC00 \\uC8FC\\uAE30\\uC801\\uC73C\\uB85C \\uAC00\\uC838\\uAC08 \\uC218 \\uC788\\uB3C4\\uB85D \\uD55C\\uB2E4. \\uC678\\uBD80\\uB9DD\\uC5D0\\uC11C \\uC811\\uADFC\\uD560 \\uC218 \\uC5C6\\uB294 \\uB0B4\\uBD80\\uC2DC\\uC2A4\\uD15C\\uC758 \\uBA54\\uD2B8\\uB9AD\\uC744 \\uD504\\uB85D\\uC2DC \\uD615\\uD0DC\\uB85C \\uC81C\\uACF5\\uD558\\uB294 \\uC6A9\\uB3C4\\uB85C \\uC0AC\\uC6A9\\uB41C\\uB2E4.\"}),(0,e.jsxs)(n.h4,{id:\"k8s-\\uD658\\uACBD\\uC5D0\\uC11C-\\uC218\\uC9D1-\\uB300\\uC0C1\\uC740-3\\uAC00\\uC9C0\\uB2E4\",children:[(0,e.jsx)(n.a,{href:\"#k8s-\\uD658\\uACBD\\uC5D0\\uC11C-\\uC218\\uC9D1-\\uB300\\uC0C1\\uC740-3\\uAC00\\uC9C0\\uB2E4\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"k8s \\uD658\\uACBD\\uC5D0\\uC11C \\uC218\\uC9D1 \\uB300\\uC0C1\\uC740 3\\uAC00\\uC9C0\\uB2E4.\"]}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:\"container (cAdvisor)\"}),(0,e.jsx)(n.li,{children:\"k8s Node(node-exporter)\"})]}),(0,e.jsx)(n.ul,{children:(0,e.jsx)(n.li,{children:'-\u003e \"/metrics\" \\uB85C http api \\uB85C \\uC81C\\uACF5\\uB41C\\uB2E4.'})}),(0,e.jsx)(n.ol,{start:\"3\",children:(0,e.jsx)(n.li,{children:\"\\uD074\\uB7EC\\uC2A4\\uD130 \\uBA54\\uD0C0\\uB370\\uC774\\uD130(kube-state-metrics)\"})}),(0,e.jsx)(n.ul,{children:(0,e.jsx)(n.li,{children:'-\u003e \"/metrics\" \\uB85C http api \\uB85C \\uC81C\\uACF5\\uB41C\\uB2E4.'})}),(0,e.jsxs)(n.h3,{id:\"k8s-\\uD658\\uACBD\\uC5D0\\uC11C\\uC758-\\uC11C\\uBE44\\uC2A4-\\uB514\\uC2A4\\uCEE4\\uBC84\\uB9AC\",children:[(0,e.jsx)(n.a,{href:\"#k8s-\\uD658\\uACBD\\uC5D0\\uC11C\\uC758-\\uC11C\\uBE44\\uC2A4-\\uB514\\uC2A4\\uCEE4\\uBC84\\uB9AC\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"k8s \\uD658\\uACBD\\uC5D0\\uC11C\\uC758 \\uC11C\\uBE44\\uC2A4 \\uB514\\uC2A4\\uCEE4\\uBC84\\uB9AC\"]}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:\"\\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4 \\uC11C\\uBC84\\uB294 \\uCEE8\\uD53C\\uADF8\\uB9F5\\uC5D0 \\uAE30\\uB85D\\uB41C \\uB0B4\\uC6A9\\uC744 \\uBC14\\uD0D5\\uC73C\\uB85C \\uB300\\uC0C1\\uC744 \\uC77D\\uC5B4\\uC635\\uB2C8\\uB2E4.\"}),(0,e.jsx)(n.li,{children:\"\\uC77D\\uC5B4\\uC628 \\uB300\\uC0C1\\uC5D0 \\uB300\\uD55C \\uBA54\\uD2B8\\uB9AD\\uC744 \\uAC00\\uC838\\uC624\\uAE30 \\uC704\\uD574 API\\uC11C\\uBC84\\uC5D0 \\uC815\\uBCF4\\uB97C \\uC694\\uCCAD\\uD569\\uB2C8\\uB2E4\"}),(0,e.jsx)(n.li,{children:\"\\uC694\\uCCAD\\uC744 \\uD1B5\\uD574 \\uC54C\\uC544\\uC628 \\uACBD\\uB85C\\uB85C \\uBA54\\uD2B8\\uB9AD \\uB370\\uC774\\uD130\\uB97C \\uC218\\uC9D1\\uD569\\uB2C8\\uB2E4.\"})]}),(0,e.jsx)(n.p,{children:\"\\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4 \\uC11C\\uBC84\\uAC00 API\\uC11C\\uBC84\\uAC00 \\uC8FC\\uAE30\\uC801\\uC73C\\uB85C \\uB370\\uC774\\uD130\\uB97C \\uC8FC\\uACE0\\uBC1B\\uC544 \\uC218\\uC9D1 \\uB300\\uC0C1\\uC744 \\uC5C5\\uB370\\uC774\\uD2B8\\uD558\\uACE0 \\uC218\\uC9D1 \\uB300\\uC0C1\\uC5D0\\uC11C \\uACF5\\uAC1C\\uB418\\uB294 \\uBA54\\uD2B8\\uB9AD\\uC744 \\uC790\\uB3D9\\uC73C\\uB85C \\uC218\\uC9D1\\uD569\\uB2C8\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uC218\\uC9D1\\uD558\\uB294 \\uBC29\\uBC95 2\\uAC00\\uC9C0\"}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"k8s api \\uC11C\\uBC84\\uC5D0 \\uC9C1\\uC811 \\uC5F0\\uACB0\\uD558\\uC5EC \\uBA54\\uD2B8\\uB9AD\\uC744 \\uC218\\uC9D1\\uD558\\uB294 cAdvisor,\"}),(0,e.jsx)(n.li,{children:\"API \\uC11C\\uBC84\\uAC00 \\uC54C\\uB824\\uC900 \\uACBD\\uB85C\\uB85C \\uBA54\\uD2B8\\uB9AD\\uC744 \\uC218\\uC9D1\\uD558\\uB294 agent(exporter)\"})]}),(0,e.jsxs)(n.h4,{id:\"cadvisor\",children:[(0,e.jsx)(n.a,{href:\"#cadvisor\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"cAdvisor\"]}),(0,e.jsx)(n.p,{children:\"cAdvisor\\uC758 \\uBA54\\uD2B8\\uB9AD\\uC740 container\\uB77C\\uB294 \\uC774\\uB984\\uC73C\\uB85C \\uC2DC\\uC791\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"Graph \\uBA54\\uB274\\uC758 \\uCFFC\\uB9AC \\uC785\\uB825\\uAE30\\uC5D0\\uC11C Execute\\uB97C \\uB204\\uB974\\uBA74 \\uC2E4\\uD589\\uB41C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uC2E4\\uD589\\uC2DC\\uAC04(LoadTime), \\uC218\\uC9D1\\uB41C \\uB370\\uC774\\uD130\\uB85C \\uC9C0\\uC815\\uB41C second graph(Resolution) \\uC218\\uC9D1\\uB41C \\uACB0\\uACFC \\uAC2F\\uC218(TotaltimeSeries)\"}),(0,e.jsx)(n.p,{children:\"PromQL\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-Bash\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#label\\uC774 nginx\\uC778 \\uCEE8\\uD14C\\uC774\\uB108\\uC758 \\uBA54\\uBAA8\\uB9AC \\uC0AC\\uC6A9\\uB7C9 \\uAC80\\uC0C9\\uD558\\uAE30\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"container_memory_usage_bytes\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"{\"}),\"container\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token string\",children:'\"nginx\"'}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"}\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"kubectl create deployment nginx --image\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`nginx\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#\\uBC30\\uD3EC \\uC774\\uD6C4 ConfigMap\\uC5D0 \\uC218\\uC9D1 \\uB300\\uC0C1\\uC774 \\uC9C0\\uC815\\uB418\\uC5B4 \\uC704 \\uCFFC\\uB9AC\\uC5D0 \\uACB0\\uACFC\\uAC00 \\uBCF4\\uC778\\uB2E4.\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#\\uCEE8\\uD53C\\uADF8\\uB9F5 \\uD655\\uC778\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"kubectl get configmap prometheus-server -o yaml \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"nl\"}),`\n`]})]})}),(0,e.jsxs)(n.h4,{id:\"exporter\",children:[(0,e.jsx)(n.a,{href:\"#exporter\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Exporter\"]}),(0,e.jsx)(n.p,{children:\"Service Discovery\\uB97C \\uD1B5\\uD574 \\uC218\\uC9D1\\uC740 \\uC790\\uB3D9\\uC73C\\uB85C \\uB418\\uC9C0\\uB9CC \\uC775\\uC2A4\\uD3EC\\uD130\\uB294 \\uC0AC\\uC804\\uC791\\uC5C5 2\\uAC00\\uC9C0\\uB97C \\uBA3C\\uC800 \\uD574\\uC57C\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.ol,{children:[(0,e.jsx)(n.li,{children:\"API \\uC11C\\uBC84\\uC5D0 \\uB4F1\\uB85D\\uB3FC \\uACBD\\uB85C\\uB97C \\uC54C \\uC218 \\uC788\\uAC8C \\uD55C\\uB2E4.\"}),(0,e.jsx)(n.li,{children:\"Exporter\\uAC00 \\uB370\\uC774\\uD130\\uB97C Prometheus type\\uC73C\\uB85C expose \\uD55C\\uB2E4.\"})]}),(0,e.jsx)(n.p,{children:\"nginx-status-annot\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` apps/v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deployment\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"selector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"template\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"labels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4 \\uC11C\\uBC84\\uAC00 \\uBC30\\uD3EC\\uB41C \\uC560\\uD50C\\uB9AC\\uCF00\\uC774\\uC158\\uC744 \\uCC3E\\uACE0 \\uBA54\\uD2B8\\uB9AD\\uC744 \\uC218\\uC9D1\\uD558\\uAC8C \\uD558\\uB294 annotation \\uC124\\uC815\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# API \\uC11C\\uBC84\\uC5D0 \\uB4F1\\uB85D\\uD558\\uB294 \\uAC83\\uC73C\\uB85C, \\uC774 \\uC124\\uC815\\uC740 expose \\uD558\\uC9C0 \\uC54A\\uB294\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"annotations\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"prometheus.io/port\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'80'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"prometheus.io/scrape\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'true'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" sysnet4admin/nginx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`status\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ports\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containerPort\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),`\n`]})]})}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"apiVersion\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` apps/v1\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kind\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` Deployment\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"selector\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"matchLabels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"template\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"metadata\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"labels\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"app\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"annotations\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"prometheus.io/port\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'9113'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"prometheus.io/scrape\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'true'\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"spec\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` nginx\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" sysnet4admin/nginx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`status\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ports\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"containerPort\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"80\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# nginx-exporter container\\uB97C sidecar\\uB85C pod \\uB0B4\\uC5D0 \\uC124\\uCE58\\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\uC774 container\\uAC00 scrape_uri\\uB85C \\uC811\\uC18D\\uD558\\uC5EC nginx\\uC758 status\\uB97C scrape\\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" nginx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),`exporter\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"image\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" nginx/nginx\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"prometheus\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\"exporter\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`0.8.0\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"          \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"env\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"            \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),\" \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"name\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` SCRAPE_URI\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"              \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"value\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" http\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\"//localhost\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`80/stub_status\n`]})]})}),(0,e.jsx)(n.p,{children:(0,e.jsx)(n.a,{href:\"https://github.com/prometheus/node_exporter\",children:\"https://github.com/prometheus/node_exporter\"})}),(0,e.jsx)(n.p,{children:\"node exporter\\uB294 /proc, /sys \\uBA54\\uD2B8\\uB9AD\\uC73C\\uB85C \\uB178\\uCD9C\\uD558\\uC5EC \\uAD6C\\uD604\\uB418\\uC5B4 \\uC788\\uB2E4. \\uBA54\\uD2B8\\uB9AD \\uC774\\uB984\\uC740 node_ \\uB85C \\uC2DC\\uC791\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"/proc\\uC740 \\uB9AC\\uB205\\uC2A4\\uC5D0\\uC11C \\uB3D9\\uC791\\uC911\\uC778 \\uD504\\uB85C\\uC138\\uC2A4\\uC758 \\uC815\\uBCF4\\uB97C filesystem \\uD615\\uD0DC\\uB85C \\uC5F0\\uACB0\\uD55C \\uB514\\uB809\\uD130\\uB9AC\\uB2E4. /sys \\uB294 I/O \\uC7A5\\uCE58(\\uC800\\uC7A5 \\uC7A5\\uCE58, \\uB124\\uD2B8\\uC6CC\\uD06C, \\uC785\\uCD9C\\uB825 \\uC7A5\\uCE58) \\uB4F1\\uC744 OS\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uC5F0\\uACB0\\uB41C \\uB514\\uB809\\uD130\\uB9AC\\uB2E4.\"}),(0,e.jsxs)(n.h4,{id:\"kube-state-metric\",children:[(0,e.jsx)(n.a,{href:\"#kube-state-metric\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"kube state metric\"]}),(0,e.jsx)(n.p,{children:\"kube-state-metrics(KSM)\\uB294 \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4 API \\uC11C\\uBC84\\uB97C \\uB9AC\\uC2A4\\uB2DD\\uD558\\uC5EC \\uC624\\uBE0C\\uC81D\\uD2B8\\uC758 \\uC0C1\\uD0DC\\uC5D0 \\uB300\\uD55C \\uBA54\\uD2B8\\uB9AD\\uC744 \\uC0DD\\uC131\\uD558\\uB294 \\uAC04\\uB2E8\\uD55C \\uC11C\\uBE44\\uC2A4\\uC774\\uB2E4. \\uAC1C\\uBCC4 \\uCFE0\\uBC84\\uB124\\uD2F0\\uC2A4 \\uAD6C\\uC131 \\uC694\\uC18C\\uC758 \\uC0C1\\uD0DC\\uAC00 \\uC544\\uB2C8\\uB77C \\uBC30\\uD3EC, \\uB178\\uB4DC \\uBC0F \\uD30C\\uB4DC\\uC640 \\uAC19\\uC740 \\uB0B4\\uBD80\\uC758 \\uB2E4\\uC591\\uD55C \\uC624\\uBE0C\\uC81D\\uD2B8\\uC758 \\uC0C1\\uD0DC\\uC5D0 \\uC911\\uC810\\uC744 \\uB454\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4\\uAC00 \\uBC1B\\uC544\\uB4E4\\uC77C \\uC218 \\uC788\\uB294 \\uC720\\uD615\\uC73C\\uB85C \\uBCC0\\uD658\\uD558\\uC5EC /metrics \\uC8FC\\uC18C\\uB85C \\uACF5\\uAC1C\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uAC01 \\uB178\\uB4DC\\uC758 \\uD2B9\\uC815 \\uB514\\uB809\\uD130\\uB9AC\\uB97C \\uB9C8\\uC6B4\\uD2B8\\uD574\\uC11C \\uC0AC\\uC6A9\\uD558\\uC9C0 \\uC54A\\uACE0 \\uC774\\uBBF8 API \\uC11C\\uBC84\\uC5D0 \\uBAA8\\uC778 \\uAC12\\uB4E4\\uC744 \\uC218\\uC9D1\\uD558\\uB294 \\uAC83\\uC774 Node Exporter\\uC640 \\uB2E4\\uB978\\uC810\\uC774\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uBA54\\uD2B8\\uB9AD \\uC774\\uB984\\uC740 kube_ \\uB85C \\uC2DC\\uC791\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.h4,{id:\"\\uBA54\\uD2B8\\uB9AD\",children:[(0,e.jsx)(n.a,{href:\"#\\uBA54\\uD2B8\\uB9AD\",\"aria-hidden\":\"true\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uBA54\\uD2B8\\uB9AD\"]}),(0,e.jsx)(n.p,{children:\"\\uBA54\\uD2B8\\uB9AD \\uC885\\uB958\"}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"\\uCE74\\uC6B4\\uD130\"}),\" \\uB204\\uC801\\uB41C\\uAC12\\uC744 \\uD45C\\uD604, \\uAC12\\uC744 \\uAD6C\\uAC04\\uBCC4\\uB85C \\uBCC0\\uD654\\uC728\\uC744 \\uD30C\\uC545\\uD574 \\uD574\\uB2F9 \\uAC12\\uC774 \\uC5B4\\uB290 \\uC815\\uB3C4 \\uCD94\\uC138\\uB85C \\uC99D\\uAC00\\uD558\\uB294\\uC9C0 \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uACE0 \\uC774\\uBCA4\\uD2B8\\uB098 \\uC624\\uB958 \\uB4F1\\uC774 \\uAE09\\uC99D\\uD558\\uB294 \\uAD6C\\uAC04\\uC744 \\uD30C\\uC545\\uD558\\uB294 \\uB370 \\uC801\\uD569\\uD568\"]}),(0,e.jsx)(n.p,{children:\"\\uCE74\\uC6B4\\uD130 \\uAC12 \\uBA54\\uD2B8\\uB9AD node_cpu_seconds_total kube_pod_container_status_restarts_total\"}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"\\uAC8C\\uC774\\uC9C0\"}),\" \\uD2B9\\uC815 \\uC2DC\\uC810\\uC758 \\uAC12\\uC744 \\uD45C\\uD604, \\uAC8C\\uC774\\uC9C0\\uB294 \\uC2DC\\uC810\\uBCC4\\uB85C \\uC99D\\uAC00\\uB098 \\uAC10\\uC18C\\uB97C \\uBAA8\\uB450 \\uD45C\\uD604\\uD558\\uBA70, CPU\\uC628\\uB3C4\\uB098 \\uBA54\\uBAA8\\uB9AC \\uC0AC\\uC6A9\\uB7C9 \\uB4F1\\uC740 \\uB204\\uC801\\uB41C \\uAC12(\\uCE74\\uC6B4\\uD130)\\uAC00 \\uD544\\uC694\\uD558\\uC9C0 \\uC54A\\uACE0 \\uC870\\uD68C\\uD558\\uB294 \\uC21C\\uAC04 \\uAC12\\uC774 \\uC911\\uC694\\uD558\\uBBC0\\uB85C \\uAC8C\\uC774\\uC9C0 \\uD0C0\\uC785\\uC744 \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uAC8C\\uC774\\uC9C0 \\uAC12 \\uBA54\\uD2B8\\uB9AD \\uC811\\uBBF8\\uC0AC _bytes _created\"}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"\\uD788\\uC2A4\\uD1A0\\uADF8\\uB7A8\"}),\" \\uC0AC\\uC804\\uC5D0 \\uBBF8\\uB9AC \\uC815\\uC758\\uD55C \\uAD6C\\uAC04 \\uC548\\uC5D0 \\uC788\\uB294 \\uBA54\\uD2B8\\uB9AD \\uAC12\\uC758 \\uBE48\\uB3C4\\uB97C \\uCE21\\uC815 \\uC775\\uC2A4\\uD3EC\\uD130 \\uAD6C\\uD604 \\uB2E8\\uACC4\\uC5D0\\uC11C \\uAD6C\\uAC04(\\uBC84\\uD0B7)\\uC744 \\uC815\\uC758\\uD55C\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"\\uC720\\uC2A4\\uCF00\\uC774\\uC2A4\"}),\" http \\uC694\\uCCAD\\uC758 \\uC751\\uB2F5 \\uC2DC\\uAC04\\uC5D0 \\uB9DE\\uB294 \\uBC84\\uD0B7\\uC774 \\uAC12\\uC744 \\uCD94\\uAC00\\uD558\\uACE0 \\uC774\\uBCA4\\uD2B8 \\uD69F\\uC218\\uB97C \\uC800\\uC7A5\\uD558\\uB294 \\uB370 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB2E4.\"]}),(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"\\uC11C\\uBA38\\uB9AC\"}),\" \\uD788\\uC2A4\\uD1A0\\uADF8\\uB7A8\\uACFC \\uC720\\uC0AC\\uD558\\uAC8C \\uAD6C\\uAC04 \\uB0B4 \\uBA54\\uD2B8\\uB9AD \\uAC12\\uC758 \\uBE48\\uB3C4\\uB97C \\uCE21\\uC815\\uD55C\\uB2E4. \\uD788\\uC2A4\\uD1A0\\uADF8\\uB7A8\\uACFC \\uCC28\\uC774\\uC810\\uC740 \\uAD6C\\uAC04\\uC774 \\uC9C0\\uC815\\uB418\\uB294 \\uAC83\\uC774 \\uC544\\uB2C8\\uB77C \\uD504\\uB85C\\uBA54\\uD14C\\uC6B0\\uC2A4\\uC758 \\uB85C\\uC9C1\\uC5D0 \\uB530\\uB77C 0~1 \\uAD6C\\uAC04\\uC774 \\uC815\\uD574\\uC838 \\uC788\\uB2E4.\"]}),(0,e.jsx)(n.p,{children:\"\\uBA54\\uD2B8\\uB9AD \\uAC12 \\uD0C0\\uC785\\uC740 \\uC544\\uB798\\uCC98\\uB7FC \\uC694\\uCCAD\\uD588\\uC744 \\uB54C \\uACB0\\uACFC\\uC5D0\\uC11C comment\\uC73C\\uB85C \\uD655\\uC778\\uD560 \\uC218 \\uC788\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"code-highlight language-bash\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"curl\"}),\" -s \",(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".1.10:9100/metrics \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"nl\"}),\" \",(0,e.jsx)(n.span,{className:\"token operator\",children:\"|\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"grep\"}),` node_memory_MemAvailable_bytes\n`]})})})]})}}var b=x;return _;})();\n;return Component;","toc":[{"value":"프로메테우스 역할","url":"#프로메테우스-역할","depth":4},{"value":"node exporter","url":"#node-exporter","depth":4},{"value":"kube-state-metrics","url":"#kube-state-metrics","depth":4},{"value":"alertmanager","url":"#alertmanager","depth":4},{"value":"pushgateway","url":"#pushgateway","depth":4},{"value":"k8s 환경에서 수집 대상은 3가지다.","url":"#k8s-환경에서-수집-대상은-3가지다","depth":4},{"value":"k8s 환경에서의 서비스 디스커버리","url":"#k8s-환경에서의-서비스-디스커버리","depth":3},{"value":"cAdvisor","url":"#cadvisor","depth":4},{"value":"Exporter","url":"#exporter","depth":4},{"value":"kube state metric","url":"#kube-state-metric","depth":4},{"value":"메트릭","url":"#메트릭","depth":4}],"frontMatter":{"readingTime":{"text":"5 min read","minutes":4.61,"time":276600,"words":922},"slug":"prometheus_johoon","fileName":"prometheus_johoon.mdx","title":"prometheus johoon","date":"2023-05-31T03:03:00.000Z","lastmod":"2023-05-31","tags":["alert"],"draft":false,"summary":"","layout":"PostSimple"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.155,"time":9300,"words":31},"slug":["default"],"fileName":"default.md","name":"demian11k","avatar":"/static/images/avatar.png","email":"demian11k@gmail.com","github":"https://github.com/demian9k","date":null}],"prev":{"title":"prometheus","date":"2023-05-30T03:03:00.000Z","lastmod":"2023-05-30","tags":["alert"],"draft":false,"summary":"","layout":"PostSimple","slug":"prometheus"},"next":{"title":"K8S manifest - Volume","date":"2023-06-01T03:03:00.000Z","lastmod":"2023-06-01","tags":["kubernetes"],"draft":false,"summary":"","layout":"PostSimple","slug":"k8s_manifest_Volume"}},"__N_SSG":true},"page":"/blog/[...slug]","query":{"slug":["prometheus_johoon"]},"buildId":"_epZdIX6LUAs-N565XCV9","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>