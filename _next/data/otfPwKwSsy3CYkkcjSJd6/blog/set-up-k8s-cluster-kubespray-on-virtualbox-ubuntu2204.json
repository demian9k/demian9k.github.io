{"pageProps":{"post":{"mdxSource":"var Component=(()=>{var r=Object.create;var l=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var h=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty;var i=a=>l(a,\"__esModule\",{value:!0});var u=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports),N=(a,s)=>{i(a);for(var c in s)l(a,c,{get:s[c],enumerable:!0})},k=(a,s,c)=>{if(s&&typeof s==\"object\"||typeof s==\"function\")for(let n of m(s))!p.call(a,n)&&n!==\"default\"&&l(a,n,{get:()=>s[n],enumerable:!(c=d(s,n))||c.enumerable});return a},g=a=>k(i(l(a!=null?r(h(a)):{},\"default\",a&&a.__esModule&&\"default\"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var t=u((x,o)=>{o.exports=_jsx_runtime});var v={};N(v,{default:()=>f,frontmatter:()=>b});var e=g(t()),b={title:\"Setting up a Kubernetes Cluster using Kubespray on VirtualBox with Ubuntu 22.04\",date:new Date(1685844131e3),lastmod:\"2023-06-04\",tags:[\"kubernetes\",\"ubuntu\",\"virtualbox\"],draft:!1,summary:\"\",layout:\"PostSimple\",canonicalUrl:\"https://demian9k.github.io/blog/set-up-k8s-cluster-kubespray-on-virtualbox-ubuntu2204/\"};function y(a={}){let{wrapper:s}=a.components||{};return s?(0,e.jsx)(s,Object.assign({},a,{children:(0,e.jsx)(c,{})})):c();function c(){let n=Object.assign({h2:\"h2\",a:\"a\",span:\"span\",h4:\"h4\",ul:\"ul\",li:\"li\",p:\"p\",h3:\"h3\",pre:\"pre\",code:\"code\",br:\"br\"},a.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.h2,{id:\"step1-vm-network-setup\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#step1-vm-network-setup\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Step1. VM network setup\"]}),(0,e.jsxs)(n.h4,{id:\"configure-virtualbox-host-only-network-cidr-manual\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#configure-virtualbox-host-only-network-cidr-manual\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Configure VirtualBox host-only network CIDR (manual)\"]}),(0,e.jsx)(n.ul,{children:(0,e.jsx)(n.li,{children:\"192.168.100.0/24\"})}),(0,e.jsxs)(n.h4,{id:\"\\uD074\\uB7EC\\uC2A4\\uD130-\\uB178\\uB4DC\\uAC00-\\uB420-\\uD638\\uC2A4\\uD2B8-\\uBAA9\\uB85D\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#\\uD074\\uB7EC\\uC2A4\\uD130-\\uB178\\uB4DC\\uAC00-\\uB420-\\uD638\\uC2A4\\uD2B8-\\uBAA9\\uB85D\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\uD074\\uB7EC\\uC2A4\\uD130 \\uB178\\uB4DC\\uAC00 \\uB420 \\uD638\\uC2A4\\uD2B8 \\uBAA9\\uB85D\"]}),(0,e.jsxs)(n.ul,{children:[(0,e.jsx)(n.li,{children:\"myclusternode01\"}),(0,e.jsx)(n.li,{children:\"myclusternode02\"}),(0,e.jsx)(n.li,{children:\"myclusternode03\"})]}),(0,e.jsx)(n.p,{children:\"\\uAC01 host\\uB4E4\\uC740 \\uCCAB\\uBC88\\uC9F8 nic\\uB294 DHCP\\uB97C \\uC0AC\\uC6A9\\uD55C NAT\\uAC00 \\uC801\\uC6A9\\uB41C \\uAC83\\uC744 \\uC0AC\\uC6A9\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"\\uB450\\uBC88\\uC9F8 NIC\\uB294 host-only nic ip\\uB97C \\uAC16\\uB294\\uB2E4. \\uC544\\uB798 \\uB0B4\\uC6A9\\uC740 /etc/hosts \\uD30C\\uC77C\\uC5D0 \\uB4F1\\uB85D\\uB41C\\uB2E4.\"}),(0,e.jsx)(n.p,{children:\"windows host-only network\\uC758 nic\\uB294 192.168.100.100 \\uC73C\\uB85C \\uC124\\uC815\\uD558\\uC5EC windows host\\uC5D0\\uC11C \\uAC01 myclusternode \\uC758 host-only \\uB124\\uD2B8\\uC6CC\\uD06C\\uC5D0 \\uC5F0\\uACB0\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.h2,{id:\"step2-setup-hosts\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#step2-setup-hosts\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Step2. Setup hosts\"]}),(0,e.jsxs)(n.h3,{id:\"register-hostnames\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#register-hostnames\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"register hostnames\"]}),(0,e.jsx)(n.p,{children:\"\\uAC01 \\uD638\\uC2A4\\uD2B8\\uB4E4\\uC744 \\uC774\\uB984\\uC73C\\uB85C \\uC2DD\\uBCC4\\uD558\\uB3C4\\uB85D hosts\\uC5D0 \\uB4F1\\uB85D\\uD55C\\uB2E4. \\uBAA8\\uB4E0 \\uD638\\uC2A4\\uD2B8\\uC5D0 \\uB4F1\\uB85D\\uB418\\uC5B4\\uC57C \\uD55C\\uB2E4.\"}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"/etc/hosts\"}),(0,e.jsx)(n.pre,{children:(0,e.jsxs)(n.code,{className:\"code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`192.168.100.1 myclusternode01\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`192.168.100.2 myclusternode02\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`192.168.100.3 myclusternode03\n`})]})}),(0,e.jsxs)(n.h3,{id:\"sudoers\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#sudoers\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"sudoers\"]}),(0,e.jsx)(n.p,{children:\"sudo \\uBA85\\uB839\\uC5B4 \\uC0AC\\uC6A9\\uC2DC \\uBE44\\uBC00\\uBC88\\uD638\\uB97C \\uC785\\uB825\\uD558\\uC9C0 \\uC54A\\uB3C4\\uB85D sudoers \\uC124\\uC815\\uC744 \\uD55C\\uB2E4.\"}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"/etc/sudoers\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"demian \",(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"ALL\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),\"ALL\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),` NOPASSWD:ALL\n`]})})}),(0,e.jsxs)(n.h3,{id:\"netplan\\uC5D0\\uC11C-static-ip-\\uC124\\uC815\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#netplan\\uC5D0\\uC11C-static-ip-\\uC124\\uC815\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"netplan\\uC5D0\\uC11C static ip \\uC124\\uC815\"]}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"/etc/netplan/00-installer-config.yaml\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"network\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ethernets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enp0s3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"dhcp4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# NAT\\uB97C \\uC0AC\\uC6A9\\uD574 \\uD638\\uC2A4\\uD2B8\\uC758 \\uC778\\uD130\\uB137 \\uC5F0\\uACB0\\uC744 \\uC0AC\\uC6A9\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D \\uC124\\uC815\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enp0s8\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"addresses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` 192.168.100.1/24\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"nameservers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"addresses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"8.8.8.8\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" 8.8.4.4\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"version\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"change-apt-sources-url\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#change-apt-sources-url\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"change APT sources url\"]}),(0,e.jsx)(n.p,{children:\"\\uB354 \\uBE60\\uB978 \\uC758\\uC874\\uC131 \\uD30C\\uC77C \\uB2E4\\uC6B4\\uB85C\\uB4DC\\uB97C \\uC704\\uD574 \\uAE30\\uBCF8\\uAC12 apt source list\\uB97C \\uBCC0\\uACBD\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsx)(n.code,{className:\"language-bash code-highlight\",children:(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sed\"}),\" -i \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'s/kr.archive.ubuntu.com/mirror.kakao.com/g'\"}),` /etc/apt/sources.list\n`]})})}),(0,e.jsxs)(n.h3,{id:\"setup-ansible-dependencies\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#setup-ansible-dependencies\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"setup ansible dependencies\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"apt\"}),` update\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"apt\"}),` upgrade\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# python3 \\uC124\\uCE58\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"apt\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),` python3-pip python3-setuptools python3-virtualenv -y\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"configure-os-environment\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#configure-os-environment\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"configure OS environment\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# swap memory \\uB044\\uAE30\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),` swapoff -a\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\uD30C\\uC77C\\uC2DC\\uC2A4\\uD15C \\uD14C\\uC774\\uBE14(/etc/fstab) \\uC5D0\\uC11C swap \\uAD00\\uB828 \\uBB38\\uC790\\uC5F4\\uC744 \\uC0AD\\uC81C\\uD558\\uC5EC swap \\uAD00\\uB828 \\uAE30\\uB2A5\\uC744 disable \\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sed\"}),\" -i \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'/swap/d'\"}),` /etc/fstab\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\uBC29\\uD654\\uBCBD disable\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`systemctl stop ufw\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`systemctl disable ufw\n`})]})}),(0,e.jsx)(\"hr\",{}),(0,e.jsxs)(n.p,{children:[\"\\uC774\\uD6C4 \\uACFC\\uC815\\uC740 \\uAC01 vm\\uC744 virtualbox\\uC5D0\\uC11C \\uBCF5\\uC81C \\uD6C4 myclusternode02, myclusternode03\\uC73C\\uB85C \\uBCF5\\uC81C\\uD6C4 \\uC9C4\\uD589\\uD55C\\uB2E4.\",(0,e.jsx)(n.br,{}),\"\\uBCF5\\uC81C\\uC2DC NIC\\uC758 Mac address\\uB294 \\uC0C8\\uB85C \\uC0DD\\uC131\\uD558\\uB3C4\\uB85D \\uC635\\uC158\\uC744 \\uC8FC\\uC5C8\\uB2E4.\"]}),(0,e.jsxs)(n.h3,{id:\"change-node-ips-on-duplicated-vms\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#change-node-ips-on-duplicated-vms\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"change node IPs on duplicated VMs\"]}),(0,e.jsx)(n.p,{children:\"\\uBCF5\\uC81C\\uB41C vm\\uC758 netplan config\\uC758 network.ethernets.enp0s8.addresses\\uC5D0 \\uD638\\uC2A4\\uD2B8 \\uBAA9\\uB85D\\uC5D0\\uC11C \\uC815\\uC758\\uD55C ip\\uC5D0 \\uB9DE\\uB3C4\\uB85D \\uC124\\uC815\\uC744 \\uBCC0\\uACBD\\uD55C\\uB2E4.\"}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"/etc/netplan/00-installer-config.yaml\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"network\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"ethernets\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enp0s3\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"dhcp4\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"    \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"enp0s8\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"addresses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"-\"}),` 192.168.100.1/24\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# - 192.168.100.2/24  # myclusternode02\\uC758 \\uACBD\\uC6B0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# - 192.168.100.3/24  # myclusternode03\\uC758 \\uACBD\\uC6B0\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"      \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"nameservers\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"        \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"addresses\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"8.8.8.8\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\",\"}),\" 8.8.4.4\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"  \",(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"version\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token number\",children:\"2\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"change-hostname-on-duplicated-vms\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#change-hostname-on-duplicated-vms\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"change hostname on duplicated VMs\"]}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798 \\uB0B4\\uC6A9\\uC740 \\uBCF5\\uC81C\\uB41C \\uAC01 \\uD638\\uC2A4\\uD2B8\\uC5D0\\uC11C \\uC2E4\\uD589\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),` hostnamectl set-hostname myclusternode02\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"sudo\"}),\" \",(0,e.jsx)(n.span,{className:\"token function\",children:\"sed\"}),\" -i \",(0,e.jsx)(n.span,{className:\"token string\",children:\"'s/myclusternode01/myclusternode02/g'\"}),` /etc/hosts\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#\\uBCC0\\uACBD \\uD655\\uC778\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` /etc/hostname\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"generate-ssh-credentials\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#generate-ssh-credentials\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"generate ssh credentials\"]}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798 \\uB0B4\\uC6A9\\uC740 \\uBAA8\\uB4E0 \\uD638\\uC2A4\\uD2B8\\uC5D0\\uC11C \\uC2E4\\uD589\\uD55C\\uB2E4.\"}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsx)(n.span,{className:\"code-line\",children:`ssh-keygen -t ed25519\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\uAC01 \\uD638\\uC2A4\\uD2B8\\uC5D0 ssh\\uB97C \\uC774\\uC6A9\\uD558\\uC5EC \\uC811\\uC18D\\uD560 \\uC218 \\uC788\\uB3C4\\uB85D credentials\\uB97C \\uBCF5\\uC0AC\\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# ssh node02  \\uC774\\uB7F0 \\uBC29\\uC2DD\\uC73C\\uB85C \\uBE60\\uB974\\uAC8C \\uC811\\uC18D \\uAC00\\uB2A5\\uD558\\uAC8C \\uB41C\\uB2E4.\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`ssh-copy-id myclusternode01\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`ssh-copy-id myclusternode02\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`ssh-copy-id myclusternode03\n`})]})}),(0,e.jsxs)(n.h2,{id:\"step3-setup-cluster-using-kubespray\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#step3-setup-cluster-using-kubespray\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"Step3. setup cluster using kubespray\"]}),(0,e.jsx)(n.p,{children:\"\\uC544\\uB798 \\uD56D\\uBAA9\\uC740 control-plane \\uB178\\uB4DC \\uC911 \\uD55C \\uACF3\\uC5D0\\uC11C \\uC2E4\\uD589\\uD55C\\uB2E4.\"}),(0,e.jsxs)(n.h3,{id:\"setup-kubespray-dependencies\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#setup-kubespray-dependencies\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"setup kubespray dependencies\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"git\"}),` clone -b release-2.22 --single-branch https://github.com/kubernetes-sigs/kubespray\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# https://github.com/kubernetes-sigs/kubespray/blob/master/docs/ansible.md#installing-ansible\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"VENVDIR\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`kubespray-venv\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"KUBESPRAYDIR\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`kubespray\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"ANSIBLE_VERSION\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"2.12\"}),\" \",(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\uC564\\uC11C\\uBE14 \\uBC84\\uC804\\uC740 python 2.7,3.5-3.9 \\uC774\\uBA74 2.11, 3.8 \\uC704\\uB85C\\uB294 2.12\\uC774 Compatibility\\uAC00 \\uC788\\uB2E4\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"virtualenv  --python\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsxs)(n.span,{className:\"token variable\",children:[(0,e.jsx)(n.span,{className:\"token variable\",children:\"$(\"}),(0,e.jsx)(n.span,{className:\"token function\",children:\"which\"}),\" python3\",(0,e.jsx)(n.span,{className:\"token variable\",children:\")\"})]}),\" \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$VENVDIR\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"source\"}),\" \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$VENVDIR\"}),`/bin/activate\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"cd\"}),\" \",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$KUBESPRAYDIR\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"pip \",(0,e.jsx)(n.span,{className:\"token function\",children:\"install\"}),\" -U -r requirements-\",(0,e.jsx)(n.span,{className:\"token variable\",children:\"$ANSIBLE_VERSION\"}),`.txt\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"building-ansible-inventory-file\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#building-ansible-inventory-file\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"building ansible inventory file\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Copy ``inventory/sample`` as ``inventory/mycluster``\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# sample \\uC778\\uBCA4\\uD1A0\\uB9AC \\uD15C\\uD50C\\uB9BF\\uC744 \\uBCF5\\uC0AC\\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"cp\"}),` -rfp inventory/sample inventory/mycluster\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Update Ansible inventory file with inventory builder\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# IPS\\uB85C \\uC9C0\\uC815\\uD55C host ip \\uBAA9\\uB85D\\uC744 \\uB9E4\\uAC1C\\uBCC0\\uC218\\uB85C \\uC778\\uBCA4\\uD1A0\\uB9AC \\uBE4C\\uB354\\uB97C \\uC2E4\\uD589\\uD558\\uC5EC hosts.yaml \\uD30C\\uC77C\\uC744 \\uB9CC\\uB4E0\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# (hosts.yaml \\uD30C\\uC77C\\uC740 sample \\uC778\\uBCA4\\uD1A0\\uB9AC \\uD15C\\uD50C\\uB9BF\\uC5D4 \\uC874\\uC7AC\\uD558\\uC9C4 \\uC54A\\uB294\\uB2E4.)\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# HOST_PREFIX\\uB294 \\uB178\\uB4DC \\uBC88\\uD638 \\uC55E\\uC5D0 \\uBD99\\uC77C \\uC774\\uB984\\uC744 \\uC758\\uBBF8\\uD55C\\uB2E4. \\uC544\\uB798 \\uC774\\uB984\\uCC98\\uB7FC \\uC124\\uC815\\uD558\\uBA74\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# myclusternode1, myclusternode2, myclusternode3 \\uCC98\\uB7FC cluster node \\uC774\\uB984\\uACFC \\uAC01 \\uD638\\uC2A4\\uD2B8\\uC758 hostname\\uC774 \\uBCC0\\uACBD\\uB41C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\uAE30\\uC874 hostname\\uC744 \\uADF8\\uB300\\uB85C \\uC0AC\\uC6A9\\uD558\\uB824\\uBA74 USE_REAL_HOSTNAME=true \\uB85C \\uBCC0\\uC218\\uB97C set\\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# KUBE_CONTROL_HOSTS \\uAC12\\uC740 \\uC124\\uCE58\\uD558\\uB294 \\uB178\\uB4DC \\uC911 \\uBA87 \\uAC1C\\uB97C control-plane\\uC73C\\uB85C \\uC0AC\\uC6A9\\uD560 \\uAC83\\uC778\\uC9C0\\uB97C \\uACB0\\uC815\\uD558\\uB294 \\uBCC0\\uC218\\uC774\\uBA70, \\uAE30\\uBCF8\\uAC12\\uC740 2\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token builtin class-name\",children:\"declare\"}),\" -a \",(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"IPS\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"(\"}),(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".100.1 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".100.2 \",(0,e.jsx)(n.span,{className:\"token number\",children:\"192.168\"}),\".100.3\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\")\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"HOST_PREFIX\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"myclusternode \",(0,e.jsx)(n.span,{className:\"token variable assign-left\",children:\"CONFIG_FILE\"}),(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),\"inventory/mycluster/hosts.yaml python3 contrib/inventory_builder/inventory.py \",(0,e.jsxs)(n.span,{className:\"token variable\",children:[\"${IPS\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"[\"}),\"@\",(0,e.jsx)(n.span,{className:\"token punctuation\",children:\"]\"}),\"}\"]}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# debug \\uBAA8\\uB4DC\\uAC00 \\uAE30\\uBCF8\\uAC12\\uC73C\\uB85C \\uCF1C\\uC838 \\uC788\\uC5B4 \\uC544\\uB798\\uCC98\\uB7FC \\uC5B4\\uB5A4 \\uAC12\\uB4E4\\uC774 hosts.yaml\\uC5D0 \\uCD94\\uAC00\\uB418\\uB294\\uC9C0 stdout \\uB41C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: Adding group all\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: Adding group kube_control_plane\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: Adding group kube_node\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: Adding group etcd\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: Adding group k8s_cluster\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: Adding group calico_rr\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode1 to group all\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode2 to group all\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode3 to group all\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode1 to group etcd\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode2 to group etcd\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode3 to group etcd\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode1 to group kube_control_plane\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode2 to group kube_control_plane\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode1 to group kube_node\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode2 to group kube_node\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# DEBUG: adding host myclusternode3 to group kube_node\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Review and change parameters under ``inventory/mycluster/group_vars``\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` inventory/mycluster/group_vars/all/all.yml\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token function\",children:\"cat\"}),` inventory/mycluster/group_vars/k8s_cluster/k8s-cluster.yml\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"setting-kubespray-inventory-variable\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#setting-kubespray-inventory-variable\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"setting kubespray inventory variable\"]}),(0,e.jsx)(\"div\",{className:\"remark-code-title\",children:\"inventory/mycluster/group_vars/k8s_cluster/k8s-cluster.yml\"}),(0,e.jsx)(n.pre,{className:\"language-yaml\",children:(0,e.jsxs)(n.code,{className:\"code-highlight language-yaml\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# configure arp_ignore and arp_announce to avoid answering ARP queries from kube-ipvs0 interface\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# must be set to true for MetalLB to work\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"#METAL_LB \\uC0AC\\uC6A9 \\uC608\\uC815\\uC774\\uBBC0\\uB85C true\\uB85C \\uBCC0\\uACBD\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kube_proxy_strict_arp\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"## docker for docker, crio for cri-o and containerd for containerd.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"container_manager\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),` containerd\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# audit log for kubernetes\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token atrule key\",children:\"kubernetes_audit\"}),(0,e.jsx)(n.span,{className:\"token punctuation\",children:\":\"}),\" \",(0,e.jsx)(n.span,{className:\"token boolean important\",children:\"true\"}),`\n`]})]})}),(0,e.jsxs)(n.h3,{id:\"run-playbook-to-install-k8s-cluster\",children:[(0,e.jsx)(n.a,{\"aria-hidden\":\"true\",href:\"#run-playbook-to-install-k8s-cluster\",tabIndex:\"-1\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"run playbook to install k8s cluster\"]}),(0,e.jsx)(n.pre,{className:\"language-bash\",children:(0,e.jsxs)(n.code,{className:\"language-bash code-highlight\",children:[(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Clean up old Kubernete cluster with Ansible Playbook - run the playbook as root\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# The option `--become` is required, as for example cleaning up SSL keys in /etc/,\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# uninstalling old packages and interacting with various systemd daemons.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Without --become the playbook will fail to run!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# And be mind it will remove the current kubernetes cluster (if it's running)!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# \\uC774\\uC804\\uC5D0 \\uC124\\uCE58\\uD55C \\uD754\\uC801\\uC744 \\uC0AD\\uC81C\\uD558\\uAE30 \\uC704\\uD574 hosts.yaml\\uC758 \\uD638\\uC2A4\\uD2B8 \\uBAA9\\uB85D\\uC744 \\uB300\\uC0C1\\uC73C\\uB85C reset playbook\\uC744 \\uC2E4\\uD589\\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ansible-playbook -i inventory/mycluster/hosts.yaml  --become --become-user\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`root reset.yml\n`]}),(0,e.jsx)(n.span,{className:\"code-line\",children:`\n`}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Deploy Kubespray with Ansible Playbook - run the playbook as root\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# The option `--become` is required, as for example writing SSL keys in /etc/,\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# installing packages and interacting with various systemd daemons.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# Without --become the playbook will fail to run!\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[(0,e.jsx)(n.span,{className:\"token comment\",children:\"# hosts.yaml\\uC758 \\uD638\\uC2A4\\uD2B8 \\uBAA9\\uB85D\\uC744 \\uB300\\uC0C1\\uC73C\\uB85C cluster\\uB97C \\uC124\\uCE58\\uD558\\uAE30 \\uC704\\uD574 cluster playbook\\uC744 \\uC2E4\\uD589\\uD55C\\uB2E4.\"}),`\n`]}),(0,e.jsxs)(n.span,{className:\"code-line\",children:[\"ansible-playbook -i inventory/mycluster/hosts.yaml  --become --become-user\",(0,e.jsx)(n.span,{className:\"token operator\",children:\"=\"}),`root cluster.yml\n`]})]})})]})}}var f=y;return v;})();\n;return Component;","toc":[{"value":"Step1. VM network setup","url":"#step1-vm-network-setup","depth":2},{"value":"Configure VirtualBox host-only network CIDR (manual)","url":"#configure-virtualbox-host-only-network-cidr-manual","depth":4},{"value":"클러스터 노드가 될 호스트 목록","url":"#클러스터-노드가-될-호스트-목록","depth":4},{"value":"Step2. Setup hosts","url":"#step2-setup-hosts","depth":2},{"value":"register hostnames","url":"#register-hostnames","depth":3},{"value":"sudoers","url":"#sudoers","depth":3},{"value":"netplan에서 static ip 설정","url":"#netplan에서-static-ip-설정","depth":3},{"value":"change APT sources url","url":"#change-apt-sources-url","depth":3},{"value":"setup ansible dependencies","url":"#setup-ansible-dependencies","depth":3},{"value":"configure OS environment","url":"#configure-os-environment","depth":3},{"value":"change node IPs on duplicated VMs","url":"#change-node-ips-on-duplicated-vms","depth":3},{"value":"change hostname on duplicated VMs","url":"#change-hostname-on-duplicated-vms","depth":3},{"value":"generate ssh credentials","url":"#generate-ssh-credentials","depth":3},{"value":"Step3. setup cluster using kubespray","url":"#step3-setup-cluster-using-kubespray","depth":2},{"value":"setup kubespray dependencies","url":"#setup-kubespray-dependencies","depth":3},{"value":"building ansible inventory file","url":"#building-ansible-inventory-file","depth":3},{"value":"setting kubespray inventory variable","url":"#setting-kubespray-inventory-variable","depth":3},{"value":"run playbook to install k8s cluster","url":"#run-playbook-to-install-k8s-cluster","depth":3}],"frontMatter":{"readingTime":{"text":"6 min read","minutes":5.495,"time":329700,"words":1099},"slug":"set-up-k8s-cluster-kubespray-on-virtualbox-ubuntu2204","fileName":"set-up-k8s-cluster-kubespray-on-virtualbox-ubuntu2204.mdx","title":"Setting up a Kubernetes Cluster using Kubespray on VirtualBox with Ubuntu 22.04","date":"2023-06-04T02:02:11.000Z","lastmod":"2023-06-04","tags":["kubernetes","ubuntu","virtualbox"],"draft":false,"summary":"","layout":"PostSimple","canonicalUrl":"https://demian9k.github.io/blog/set-up-k8s-cluster-kubespray-on-virtualbox-ubuntu2204/"}},"authorDetails":[{"readingTime":{"text":"1 min read","minutes":0.155,"time":9300,"words":31},"slug":["default"],"fileName":"default.md","name":"demian11k","avatar":"/static/images/avatar.png","email":"demian11k@gmail.com","github":"https://github.com/demian9k","date":null}],"prev":{"title":"K8S manifest - SecurityContext","date":"2023-06-02T02:03:00.000Z","lastmod":"2023-06-02","tags":["kubernetes"],"draft":false,"summary":"","layout":"PostSimple","slug":"k8s_manifest-SecurityContext"},"next":{"title":"Hands-On Example: Ingress and Bare Metal Load Balancer in Kubernetes","date":"2023-06-05T00:00:00.000Z","lastmod":"2023-06-05","tags":["Kubernetes","Ingress","LoadBalancer"],"draft":false,"summary":"","layout":"PostSimple","canonicalUrl":"https://demian9k.github.io/blog/ingress-ctrl-baremetal-lb-in-k8s/","slug":"ingress-ctrl-baremetal-lb-in-k8s"}},"__N_SSG":true}